!function(e){function t(t){for(var r,o,i=t[0],c=t[1],l=t[2],p=0,d=[];p<i.length;p++)o=i[p],n[o]&&d.push(n[o][0]),n[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(e[r]=c[r]);for(m&&m(t);d.length;)d.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],r=!0,i=1;i<a.length;i++){var c=a[i];0!==n[c]&&(r=!1)}r&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var r={},n={0:0},s=[];function o(t){if(r[t])return r[t].exports;var a=r[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=r,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(a,r,function(t){return e[t]}.bind(null,r));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var m=c;s.push([310,1]),a()}({308:function(e,t,a){},310:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(87),o=a(57),i=a(312),c=a(314),l=a(313),m=a(311),p=a(90),d=a(131),h=a.n(d),u=a(132),g=a.n(u);p.a.use(h.a).use(g.a).use(o.b).init({fallbackLng:"en",debug:!0,react:{wait:!0,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},detection:{order:["path","querystring","cookie","localStorage","navigator","htmlTag","subdomain"],lookupQuerystring:"lang",lookupCookie:"i18n",lookupLocalStorage:"i18nextLng"},backend:{loadPath:SiteSettings.url.api+"{{ns}}/{{lng}}"}});var f=p.a;var b=class extends n.a.Component{constructor(e){super(e),this.state={lang:"en",langs:{}},this.onLanguageChanged=this.onLanguageChanged.bind(this)}componentDidMount(){let e=this,t=(f.language,SiteSettings.url.api+"get_langs");fetch(t).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){e.setState({langs:JSON.parse(t)})}),f.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){f.off("languageChanged",this.onLanguageChanged)}onLanguageChanged(e){this.setState({lang:e})}renderLangList(){const e=this.state.langs;return n.a.createElement("select",{onChange:this.changeLang.bind(this),className:"form-control"},Object.keys(this.state.langs).map(function(t,a){const r=e[t];return n.a.createElement("option",{key:t,value:t},r.name)}))}changeLang(){}render(){return this.state.lang,n.a.createElement("header",{className:"header"},n.a.createElement("div",{className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6"},n.a.createElement("h1",{className:"site-title"},n.a.createElement(m.a,{to:SiteSettings.path},"Four Corners"))),n.a.createElement("div",{className:"col-6"},this.state.langs?this.renderLangList():this.renderEmpty()))))}};var y=()=>n.a.createElement("footer",{id:"colophon",className:"container"},n.a.createElement("div",{className:"card-footer text-center bg-transparent border-primary"},"Four Corners ",(new Date).getFullYear())),E=a(88),v=a.n(E),S=a(89);var N={title:"",type:"object",properties:{backstory:{title:"",type:"object",required:[],properties:{story:{type:"string"},author:{type:"string"},publication:{type:"string"},url:{type:"string",format:"uri"},date:{type:"string",format:"date"}}},copyright:{title:"",type:"object",required:[],properties:{copyright:{type:"string",enum:[]},credit:{type:"string"},year:{type:"string"},ethics:{type:"string",enum:[]},caption:{type:"string"}}},media:{title:"",type:"object",required:[],properties:{media:{type:"array",items:{type:"object",properties:{type:{type:"string",enum:["image","youtube","vimeo"],enumNames:["Image","YouTube","Vimeo"]},url:{type:"string",format:"uri"},credit:{type:"string"}}}}}},links:{title:"",type:"object",required:[],properties:{links:{type:"array",minItems:0,items:{type:"object",properties:{title:{type:"string"},url:{type:"string",format:"uri"}}}}}}}};var C=class extends n.a.Component{constructor(e){super(e),this.state={}}render(){const e=this.props.formData[this.props.slug];return console.log(this.props.formData),n.a.createElement("div",{className:e?"":"empty"},n.a.createElement("span",{className:"label"},this.props.slug),n.a.createElement("span",{className:"value"},e))}};let k=SiteSettings.url.theme+"/assets/images/placeholder.svg";var D=class extends n.a.Component{constructor(e){super(e),this.state={imageLoaded:!1,imgSrc:k,position:"static",includeCSS:!1,includeJS:!1},this.inputRef=n.a.createRef(),this.outputRef=n.a.createRef(),this.includeJSRef=n.a.createRef(),this.includeCSSRef=n.a.createRef(),this.colInnerRef=n.a.createRef(),this.embedderRef=n.a.createRef()}componentDidMount(){this.onScroll=this.onScroll.bind(this),window.addEventListener("scroll",this.onScroll)}componentDidUpdate(e){}onImageLoad(e){}onImageError(e){}onChangeImage(e){let t=e.target.value,a=new Image;a.onload=(()=>{this.setState({imgSrc:t,imageLoaded:!0})}),a.onerror=(()=>{this.setState({imgSrc:k,imageLoaded:!1})}),a.src=t}onChangeOpts(e){console.log(e.target.id);let t={formData:this.props.formData};t[e.target.id]=e.target.checked,this.setState(t)}onFocus(e){e.target.setSelectionRange(0,e.target.value.length)}onBlur(e){}onSubmit(e){console.log("Submit",e)}onError(e){console.log("Error",e)}onScroll(e){}createEmbedCode(e){let t={lang:f.language,img:this.state.imageLoaded?this.state.imgSrc:void 0};Object.assign(e,t);const a=JSON.stringify(e);let r="";return r+=this.state.includeJS?'<script src=https://cdn.jsdelivr.net/gh/four-corners/four-corners.js/dist/four-corners.min.js type="text/javascript"><\/script>':"",r+=this.state.includeCSS?'<link href="https://cdn.jsdelivr.net/gh/four-corners/four-corners.js/dist/four-corners.min.css" rel="stylesheet" type="text/css">':"",(r+=Object(S.renderToStaticMarkup)(n.a.createElement("div",{className:"fc_embed","data-fc":a}))).replace(/(&quot\;)/g,"'").replace(/(&amp\;)/g,"&")}render(){return n.a.createElement("div",{className:"col-inner",ref:this.colInnerRef},n.a.createElement("div",{id:"embedder",className:this.state.position,ref:this.embedderRef},n.a.createElement("div",{id:"embed",className:"card"},n.a.createElement("img",{src:this.state.imgSrc,onLoad:this.onImageLoad.bind(this),onError:this.onImageError.bind(this)}),n.a.createElement("div",{"data-id":"backstory",className:"corner tl"}),n.a.createElement("div",{"data-id":"copyright",className:"corner tr"}),n.a.createElement("div",{"data-id":"media",className:"corner br"}),n.a.createElement("div",{"data-id":"links",className:"corner bl"}),n.a.createElement("div",{id:"backstory",className:"cornerContent"},n.a.createElement("h1",null,"Backstory"),n.a.createElement(C,{formData:this.props.formData.backstory,slug:"story"}),n.a.createElement("div",{className:this.props.formData.backstory.author?"":"empty"},n.a.createElement("span",{className:"label"},"Author"),n.a.createElement("span",{className:"value"},this.props.formData.backstory.author)),n.a.createElement("div",{className:this.props.formData.backstory.publication?"":"empty"},n.a.createElement("span",{className:"label"},"Publication"),n.a.createElement("span",{className:"value"},this.props.formData.backstory.publication)),n.a.createElement("div",{className:this.props.formData.backstory.url?"":"empty"},n.a.createElement("span",{className:"label"},"URL"),n.a.createElement("span",{className:"value"},this.props.formData.backstory.url)),n.a.createElement("div",{className:this.props.formData.backstory.date?"":"empty"},n.a.createElement("span",{className:"label"},"Date"),n.a.createElement("span",{className:"value"},this.props.formData.backstory.date))),n.a.createElement("div",{id:"copyright",className:"cornerContent"},n.a.createElement("h1",null,"Copyright & Licensing"),n.a.createElement("div",{className:this.props.formData.copyright.copyright?"":"empty"},n.a.createElement("span",{className:"label"},"Copyright"),n.a.createElement("span",{className:"value"},this.props.formData.copyright.copyright)),n.a.createElement("div",{className:this.props.formData.copyright.credit?"":"empty"},n.a.createElement("span",{className:"label"},"Credit"),n.a.createElement("span",{className:"value"},this.props.formData.copyright.credit)),n.a.createElement("div",{className:this.props.formData.copyright.year?"":"empty"},n.a.createElement("span",{className:"label"},"Year"),n.a.createElement("span",{className:"value"},this.props.formData.copyright.year)),n.a.createElement("div",{className:this.props.formData.copyright.ethics?"":"empty"},n.a.createElement("span",{className:"label"},"Ethics"),n.a.createElement("span",{className:"value"},this.props.formData.copyright.ethics)),n.a.createElement("div",{className:this.props.formData.copyright.caption?"":"empty"},n.a.createElement("span",{className:"label"},"Caption"),n.a.createElement("span",{className:"value"},this.props.formData.copyright.caption))),n.a.createElement("div",{id:"media",className:"cornerContent"},n.a.createElement("h1",null,"Related Media")),n.a.createElement("div",{id:"links",className:"cornerContent"},n.a.createElement("h1",null,"Related Links"))),n.a.createElement("form",{name:"embed"},n.a.createElement("input",{className:"form-control card",name:"imageSrc",ref:this.inputRef,placeholder:"https://example.com/images/photo.jpg",onChange:this.onChangeImage.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}),n.a.createElement("textarea",{className:"output form-control",id:"json",readOnly:!0,ref:this.outputRef,rows:5,value:this.createEmbedCode(this.props.formData),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}),n.a.createElement("div",{className:"embed-opts checkboxes"},n.a.createElement("label",{className:"control-label",htmlFor:"includeJS"},n.a.createElement("input",{className:"embed-opt",id:"includeJS",name:"includeJS",type:"checkbox",defaultChecked:this.state.includeJS,onChange:this.onChangeOpts.bind(this)})," Include JavaScript file"),n.a.createElement("label",{className:"control-label",htmlFor:"includeCSS"},n.a.createElement("input",{className:"embed-opt",id:"includeCSS",name:"includeCSS",type:"checkbox",defaultChecked:this.state.includeCSS,onChange:this.onChangeOpts.bind(this)})," Include CSS file")),n.a.createElement("input",{className:"form-control card",readOnly:!0,value:"https://i.guim.co.uk/img/media/fe09d503213527013ae12c489ad7b473f35e7a8c/0_0_6720_4480/master/6720.jpg?width=1020&quality=45&auto=format&fit=max&dpr=2&s=c23858bc511a0bc8ec8c6ab52687b6b2",onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}))))}};var j={backstory:{story:{"ui:widget":"textarea","ui:options":{rows:5}}},copyright:{caption:{"ui:widget":"textarea","ui:options":{rows:5}}}};var L=class extends n.a.Component{constructor(e){super(e),this.state={creator:{},lang:"en",formData:{}},this.onLanguageChanged=this.onLanguageChanged.bind(this),this.onChange=this.onChange.bind(this),this.outputRef=n.a.createRef()}componentDidMount(){let e=this,t=(window.location.href.split("/"),f.language);console.log(f);let a=SiteSettings.url.api+"creators?lang="+t;fetch(a).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){e.setState({creator:t[0]})}),f.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){f.off("languageChanged",this.onLanguageChanged)}componentDidUpdate(){}onLanguageChanged(e){this.setState({lang:e})}translateSchema(e){const t=Object.assign({},e),a=Object.keys(e.properties);for(let r of a){let a=e.properties[r];const n=this.state.creator.acf,s=n[[r,"title"].join("_")],o=a.properties;if(a.title=s,o){const e=Object.keys(o);for(let t of e){const e=[r,t,"label"].join("_");if(n.hasOwnProperty(e)){const r=n[e];a.properties[t].title=r}const s=[r,t,"desc"].join("_");if(n.hasOwnProperty(s)){const e=n[s];a.properties[t].description=e}if(o[t].hasOwnProperty("enum")){const e=n[[r,t,"options"].join("_")];if(e)for(let r of e){const e=r.label+(r.desc?": "+r.desc:"");a.properties[t].enum.push(e)}}if("array"==o[t].type){const e=o[t].items.properties,s=Object.keys(e);for(let e of s){const s=[r,e,"label"].join("_");if(n.hasOwnProperty(s)){const r=n[s];a.properties[t].items.properties[e].title=r}}}}}t.properties[r]=a}return t}renderCreator(){return n.a.createElement("div",{id:"forms"},n.a.createElement(v.a,{schema:this.translateSchema(N),uiSchema:j,formData:this.state.formData,onChange:this.onChange,onSubmit:this.onSubmit,onError:this.onError},n.a.createElement("button",{type:"submit",hidden:!0}),n.a.createElement("button",{type:"button",className:"btn"},"Add content in another language")))}renderEmbed(){return n.a.createElement(D,{formData:this.state.formData,lang:this.state.lang})}renderEmpty(){return n.a.createElement("div",{className:"loader"})}onChange(e){const t=Object.assign(this.state.formData,e.formData);this.setState({formData:t})}onSubmit(e){}onError(e){}render(){return this.state.lang,n.a.createElement("div",{id:"creator",className:"container"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6"},this.state.creator&&this.state.creator.ID?this.renderCreator():this.renderEmpty()),n.a.createElement("div",{className:"col-6"},this.state.creator&&this.state.creator.ID?this.renderEmbed():this.renderEmpty())))}};var w=()=>React.createElement("div",null,React.createElement("div",{className:"container"},React.createElement("h1",null,"Not Found")));a(308);const O=n.a.createElement(o.a,null,e=>n.a.createElement(i.a,null,n.a.createElement(n.a.Fragment,null,n.a.createElement(b,null),n.a.createElement(c.a,null,n.a.createElement(l.a,{exact:!0,path:SiteSettings.path,component:L}),n.a.createElement(l.a,{exact:!0,path:SiteSettings.path+"creator",component:L}),n.a.createElement(l.a,{path:"*",component:w})),n.a.createElement(y,null))));Object(s.render)(O,document.getElementById("page"))}});
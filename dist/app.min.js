!function(e){function t(t){for(var s,i,o=t[0],c=t[1],l=t[2],m=0,h=[];m<o.length;m++)i=o[m],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&h.push(n[i][0]),n[i]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);for(d&&d(t);h.length;)h.shift()();return r.push.apply(r,l||[]),a()}function a(){for(var e,t=0;t<r.length;t++){for(var a=r[t],s=!0,o=1;o<a.length;o++){var c=a[o];0!==n[c]&&(s=!1)}s&&(r.splice(t--,1),e=i(i.s=a[0]))}return e}var s={},n={0:0},r=[];function i(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=s,i.d=function(e,t,a){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)i.d(a,s,function(t){return e[t]}.bind(null,s));return a},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="";var o=window.webpackJsonp=window.webpackJsonp||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var d=c;r.push([549,1]),a()}({248:function(e,t){},546:function(e,t){},547:function(e,t,a){},549:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a.n(s),r=a(14),i=a(95),o=a(552),c=a(553),l=a(554),d=a(4),m=a.n(d),h=a(134),p=a(212),u=a.n(p),g=a(213),f=a.n(g);h.a.use(u.a).use(f.a).use(i.b).init({fallbackLng:"en",debug:!0,react:{wait:!0,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},detection:{order:["path","querystring","cookie","localStorage","navigator","htmlTag","subdomain"],lookupQuerystring:"lang",lookupCookie:"i18n",lookupLocalStorage:"i18nextLng"},backend:{loadPath:siteSettings.url.api+"{{ns}}/{{lng}}"}});var v=h.a;class b extends n.a.Component{constructor(e){super(e),this.state={nextIndex:1,activeSlug:"authorship",hoveredSlug:null,fourCorners:null,time:0,corners:["authorship","backstory","imagery","links"]}}componentDidMount(){this.interval=setInterval(()=>this.cycleCorner(),1333)}componentDidUpdate(e,t,a){}componentWillUnmount(){clearInterval(this.state.time)}cycleCorner(){let e=this.state.nextIndex;const t=this.state.corners[e];e++,this.setState({activeSlug:t,nextIndex:e<this.state.corners.length?e:0})}onHover(e){const t=e.target.dataset.fcSlug,a=e.target.dataset.index;this.setState({hoveredSlug:t,activeSlug:t,nextIndex:a})}unHover(e){this.setState({hoveredSlug:null})}openPanel(e){this.setState({expandPanel:!1})}renderCorners(){const e=[];return this.state.corners.forEach((t,a)=>{let s="fc-corner fc-"+t;this.state.activeSlug!=t||this.state.hoveredSlug||(s+=" active"),e.push(n.a.createElement("div",{key:a,className:s,"data-fc-slug":t,"data-index":a,onMouseOver:this.onHover.bind(this),onMouseLeave:this.unHover.bind(this),onClick:this.openPanel.bind(this)}))}),e}renderTitles(){const e=[];return this.props.strings.demo&&this.state.corners.forEach((t,a)=>{let s="corner-title";(this.state.hoveredSlug==t||this.state.activeSlug==t&&!this.state.hoveredSlug)&&(s+=" active"),e.push(n.a.createElement("div",{key:a,className:s},m()(this.props.strings.demo[t])))}),e}render(){this.state.activeSlug;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"fc-embed-demo"},this.renderCorners(),this.renderTitles()))}}var y=b;class E extends n.a.Component{constructor(e){super(e),this.state={}}componentDidMount(){}componentDidUpdate(e,t,a){}onHover(e){}render(){return n.a.createElement("div",{id:"mc_embed_signup",className:"subscribe-form"},n.a.createElement("form",{action:this.props.formUrl,method:"post",id:"mc-embedded-subscribe-form",name:"mc-embedded-subscribe-form",className:"validate",target:"_blank",noValidate:!0},n.a.createElement("label",{htmlFor:"mce-EMAIL"},this.props.label),n.a.createElement("div",{className:"fields-group"},n.a.createElement("input",{type:"email",name:"EMAIL",className:"required email form-elem",id:"mce-EMAIL",placeholder:"email@example.org"}),n.a.createElement("div",{id:"mce-responses",className:"clear"},n.a.createElement("div",{className:"response",id:"mce-error-response",style:{display:"none"}}),n.a.createElement("div",{className:"response",id:"mce-success-response",style:{display:"none"}})),n.a.createElement("div",{style:{position:"absolute",left:"-5000px"},"aria-hidden":"true"},n.a.createElement("input",{type:"text",name:"b_a117064f3864003f8ca77acf1_fffda28ae6",tabIndex:"-1"})),n.a.createElement("input",{type:"submit",value:"",name:"subscribe",id:"mc-embedded-subscribe",className:"button"}))))}}var k=E;class N extends n.a.Component{constructor(e){super(e),this.state={lang:v.language,page:siteSettings.current,strings:siteSettings.current.strings,info:{},options:{}}}componentDidMount(){let e=this,t=siteSettings.url.api+"info";fetch(t).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){t&&e.setState({info:t})}));let a=siteSettings.url.api+"options";fetch(a).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(t){t&&e.setState({options:t})})),v.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}onLanguageChanged(e){this.setState({lang:e})}renderTopActions(){const e=this.state.strings.top_action_buttons||[];let t=[];return e.forEach((e,a)=>{t.push(n.a.createElement("a",{href:e.link,className:"action-button",key:a},n.a.createElement("div",{className:"action-text"},e.text)))}),t}renderBottomActions(){const e=this.state.strings.bottom_action_buttons||[];let t=[];return e.forEach((e,a)=>{t.push(n.a.createElement("div",{className:"col col-12 col-sm-6 left",key:a},n.a.createElement("div",{className:"col-content"},n.a.createElement("a",{href:e.link,className:"action-button full"},n.a.createElement("div",{className:"action-text"},e.text)))))}),t}render(){return n.a.createElement("main",{id:"home"},n.a.createElement("section",{id:"home-intro"},n.a.createElement("div",{className:"max-width"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-12"},n.a.createElement("div",{className:"col-content"},n.a.createElement("h1",{id:"site-tagline"},this.state.strings.tagline))),n.a.createElement("div",{className:"col col-12 col-md-6"},n.a.createElement("div",{className:"col-content"},n.a.createElement(y,{strings:this.state.strings}))),n.a.createElement("div",{className:"col col-12 col-md-6"},n.a.createElement("div",{className:"col-content"},n.a.createElement("div",{className:"actions"},this.renderTopActions()),n.a.createElement("div",{id:"home-subscribe"},n.a.createElement(k,{label:n.a.createElement("h3",null,n.a.createElement("strong",null,this.state.strings.newsletter_title)),formUrl:this.state.options.subscribe}))))))),n.a.createElement("section",{id:"home-about"},n.a.createElement("div",{className:"max-width"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-12"},m()(this.state.page.post_content))))),n.a.createElement("section",{id:"intro-end"},n.a.createElement("div",{className:"max-width"},n.a.createElement("div",{className:"row"},this.renderBottomActions()))))}}var C=N;class x extends n.a.Component{constructor(e){super(e),this.state={lang:v.language,page:siteSettings.current,strings:siteSettings.current.strings},this.onLanguageChanged=this.onLanguageChanged.bind(this)}componentDidMount(){v.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}onLanguageChanged(e){this.setState({lang:e})}renderContribs(){this.state.page;const e=this.state.strings.contributors;let t=[];return e.forEach((e,a)=>{t.push(n.a.createElement("div",{className:"col col-12 col-md-6",key:a},n.a.createElement("div",{className:"col-content"},n.a.createElement("div",{className:"content-block contrib-block"},n.a.createElement("h3",null,e.name),e.role?n.a.createElement("h4",null,e.role):"",m()(e.bio)))))}),t}render(){this.state.lang;const e=this.state.page,t=this.renderContribs();return n.a.createElement("main",{id:"about"},n.a.createElement("div",{className:"md-width"},n.a.createElement("h1",null,m()(e.post_title)),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-12"},n.a.createElement("div",{className:"col-content"},e.post_content?n.a.createElement("div",{className:"content-block"},m()(e.post_content)):"")))),n.a.createElement("div",{className:"max-width"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-12 col-md-6"},n.a.createElement("div",{className:"col-content"},n.a.createElement("div",{className:"content-block md-text"},m()(this.state.strings.desc)))),t||"")))}}var S=x,w=a(92),D=a.n(w);class _ extends n.a.Component{constructor(e){super(e),this.state={lang:v.language,embeds:{},embedHtmls:{},page:siteSettings.current,strings:siteSettings.current.strings},this.slugs=["authorship","backstory","imagery","links"],this.onLanguageChanged=this.onLanguageChanged.bind(this)}componentDidMount(){this.activateEmbeds(),v.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}componentDidUpdate(){this.activateEmbeds()}onLanguageChanged(e){this.setState({lang:e})}activateEmbeds(){var e=this.state.strings;this.state.page&&e&&this.slugs.forEach((t,a)=>{if(this.state.embedHtmls[t]){if(!this.state.embeds[t]){this.state.embedHtmls[t];const e=new D.a({elem:'.embed-wrapper[data-slug="'+t+'"] .fc-embed',active:t,static:!0});let a=this.state.embeds;a[t]=e,this.setState({embeds:a})}}else{const a=m()(e[t+"_embed"]);let s=this.state.embedHtmls;s[t]=n.a.createElement("div",{className:"embed-wrapper","data-slug":t},a),this.setState({embedHtmls:s})}})}renderIntro(){this.state.lang;const e=this.state.page;return n.a.createElement("div",{id:"how-intro",className:"row"},n.a.createElement("div",{className:"col col-12"},n.a.createElement("div",{className:"col-content"},n.a.createElement("div",{className:"content-block md-text"},m()(e.post_content)))))}renderEmbed(e,t){if(this.state.page,!this.state.strings)return;const a=this.state.strings,s=m()(a[e+"_embed"]);return n.a.createElement("div",{key:t,className:"embed-wrapper","data-slug":e},s)}renderRow(e,t){const a="row how-block"+(t%2==0?"":" reverse"),s=this.state.page;let r={};return["title","desc","embed"].forEach((t,a)=>{s&&s.strings&&s.strings[e+"_"+t]?r[t]=m()(s.strings[e+"_"+t]):r[t]=""}),n.a.createElement("div",{className:a,key:t},n.a.createElement("div",{className:"col col-12 col-md-5 left"},n.a.createElement("div",{className:"col-content"},n.a.createElement("h2",null,r.title),r.desc)),n.a.createElement("div",{className:"col col-12 col-md-7 right"},n.a.createElement("div",{className:"col-content"},n.a.createElement("div",{className:"embed-wrapper"},this.state.embedHtmls[e]))))}render(){this.state.lang;const e=this.state.page,t=this.renderIntro();let a=[];return this.slugs.forEach((e,t)=>{a.push(this.renderRow(e,t))}),n.a.createElement("main",{id:"how"},n.a.createElement("div",{className:"max-width"},n.a.createElement("h1",null,m()(e.post_title)),t||"",a||""))}}var j=_,F=a(214),L=a.n(F);a(551);n.a.Component;class O extends n.a.Component{constructor(e){super(e),this.state={lang:v.language,page:siteSettings.current,embeds:[]},this.onLanguageChanged=this.onLanguageChanged.bind(this)}componentDidMount(){v.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}componentDidUpdate(){const e=new D.a,t=new L.a("#gallery-embeds",{itemSelector:".embed-col",transitionDuration:0,gutter:0});e.forEach((function(e,a){e.elems.photo;let s=e.elems.embed;s.parentNode;s.classList.contains("loaded")||s.addEventListener("onImgLoad",(function(e){t.layout(),s.classList.add("loaded")}))}))}onLanguageChanged(e){this.setState({lang:e})}renderEmbed(){const e=this.state.page;let t=[];return e.strings.embeds.forEach((function(e,a){const s=m()(e.embed_code);t.push(n.a.createElement("div",{className:"embed-col col col-12 col-xl-6",key:a},n.a.createElement("div",{className:"embed-wrap"},n.a.createElement("h2",null,e.title),s)))})),t}render(){this.state.lang;const e=this.state.page;return n.a.createElement("main",{id:"gallery"},n.a.createElement("div",{className:"max-width"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-8 m-auto"},n.a.createElement("h1",null,m()(e.post_title)),n.a.createElement("div",{className:"col-content md-text"},e.post_content?m()(e.post_content):""))),n.a.createElement("div",{className:"row",id:"gallery-embeds"},e.strings?this.renderEmbed():"")))}}var M=O;class P extends n.a.Component{constructor(e){super(e),this.state={lang:"en",page:siteSettings.current},this.onLanguageChanged=this.onLanguageChanged.bind(this)}componentDidMount(){v.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}componentDidUpdate(){}onLanguageChanged(e){this.setState({lang:e})}render(){this.state.lang;const e=this.state.page;return n.a.createElement("main",{id:"contact"},n.a.createElement("div",{className:"md-width"},n.a.createElement("h1",null,m()(e.post_title)),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-12"},n.a.createElement("div",{className:"col-content"},e.post_content?n.a.createElement("div",{className:"content-block"},m()(e.post_content)):"")))))}}var T=P;a(294);var K={photo:{fields:{src:{type:"text",format:"url"},width:{type:"text",format:"hidden"},height:{type:"text",format:"hidden"}}},authorship:{fields:{caption:{type:"textarea",rows:2},credit:{type:"text"},license:{type:"toggle",fields:{copyright:{type:"group",fields:{year:{type:"text",style:"one-third",default:!0},holder:{type:"text",style:"two-thirds"}}},commons:{type:"select"}}},ethics:{type:"select",customize:!0},bio:{type:"textarea"},website:{type:"text",format:"url"},website:{type:"text"},contact:{type:"group",fields:{info:{type:"text"},rights:{type:"text"}}}}},backstory:{fields:{text:{type:"textarea"},media:{type:"blocks",fields:{url:{type:"text",format:"url"},caption:{type:"textarea"},credit:{type:"text"}}}}},imagery:{fields:{media:{type:"blocks",fields:{url:{type:"text",format:"url"},caption:{type:"textarea"},credit:{type:"text"}}}}},links:{fields:{links:{type:"blocks",fields:{title:{type:"text"},url:{type:"text",format:"url"}}}}},opts:{fields:{dark:{type:"checkbox"},caption:{type:"checkbox"},credit:{type:"checkbox"},logo:{type:"checkbox"}}}};a(1);class A extends n.a.Component{constructor(e){super(e),this.state={opened:!1}}onClick(e){e.preventDefault(),this.setState({opened:!this.state.opened})}onMouseEnter(e){}onMouseLeave(e){}renderToggle(){return this.props.strings.desc?n.a.createElement("div",{className:"toggle-desc"},n.a.createElement("div",{onClick:this.onClick.bind(this),onFocus:this.onClick.bind(this)})):null}render(){const e=this.props.strings,t="field-desc desc"+(this.state.opened?" opened":"");return n.a.createElement("div",{className:"field-label",id:this.props.id},e&&e.label?n.a.createElement("label",{name:this.props.fieldKey,htmlFor:this.props.fieldKey},e.label,this.renderToggle()):null,e&&e.desc?n.a.createElement("div",{className:t},e.desc):null)}}var I=A;class H extends n.a.Component{constructor(e){super(e),this.state={value:"",warn:!1,error:!1}}componentDidUpdate(){}onChange(e){const t=this,a=this.props,s=e.target.name,n=e.target.value;if("photo"===a.setKey){t.setState({error:!1});let r=new Image;r.onload=e=>{t.setState({warn:!1}),a.onChange("photo_width",r.width),a.onChange("photo_height",r.height),a.onChange(s,n)},r.onerror=e=>{t.setState({warn:"load"}),a.onChange(s,null)},r.src=e.currentTarget.value}else a.onChange(s,n)}onBlur(e){const t=this,a=this.props;e.target.name,e.target.value;"photo"===a.setKey&&this.state.warn&&t.setState({error:this.state.warn})}render(){const e=this.props,t=e.setKey,a=e.fieldKey,s=e.field.strings,r=e.field.style,i=e.field.format||"text",o=[t,a].join("_");e.field.default&&s.placeholder;const c=["field","input"];return r&&c.push(r),i&&c.push(i),this.state.error&&c.push("error"),this.state.warn&&c.push("warn"),n.a.createElement("div",{className:c.join(" ")},this.props.hideLabel?"":n.a.createElement(I,{strings:s,fieldKey:a}),n.a.createElement("input",{className:"form-elem",name:o,type:i,placeholder:s.placeholder,onBlur:this.onBlur.bind(this),onChange:this.onChange.bind(this)}),this.state.error?n.a.createElement("div",{className:"desc error-desc"},"This is not a proper URL"):"")}}var R=H;class B extends n.a.Component{constructor(e){super(e)}onChange(e){const t=e.target.name,a=e.target.value;this.props.onChange(t,a)}render(){const e=this.props.setKey,t=this.props.fieldKey,a=this.props.field.strings,s=a.placeholder,r=this.props.field.rows,i=[e,t].join("_");return n.a.createElement("div",{className:"field input"},this.props.hideLabel?"":n.a.createElement(I,{strings:a,fieldId:t}),n.a.createElement("textarea",{name:i,className:"form-elem",rows:r||6,placeholder:s,onChange:this.onChange.bind(this)}))}}var U=B;a(10);class J extends n.a.Component{constructor(e){super(e),this.state={custom:!1,customText:"",value:""},this.selectRef=n.a.createRef()}componentDidUpdate(){const e=this.props.fieldValue;e&&e!=this.state.value&&(this.setState({value:e}),e.label||this.setState({custom:e,customText:e.desc}))}onClick(e){if(e.preventDefault(),e.target.parentElement.classList.contains("toggle-desc"))return;const t=e.currentTarget.classList.contains("custom");let a=e.currentTarget.dataset.value;try{a=JSON.parse(a)}catch(e){console.warn(e)}"TEXTAREA"!==e.target.nodeName&&e.currentTarget.classList.contains("selected")&&(a={}),this.setState({value:a,custom:t});const s=this.selectRef.current.name;this.props.onChange(s,a)}onChangeCustom(e){const t=e.currentTarget.value,a={desc:t};this.setState({custom:!0,customText:t,value:a});const s=this.selectRef.current.name;this.props.onChange(s,a)}render(){const e=this.props.fieldKey,t=this.props.field.strings,a=[this.props.setKey,e].join("_"),s=this.props.field.options,r=this.state.value,i=this.props.field.customize;return n.a.createElement("div",{className:"field select"},this.props.hideLabel?"":n.a.createElement(I,{strings:t,fieldKey:e}),n.a.createElement("select",{name:a,className:"form-elem",ref:this.selectRef,onChange:this.onChange},s?s.map((e,t)=>{const a=JSON.stringify(e);let s=e.label,r=e.desc;return n.a.createElement("option",{key:t,value:a},s+(r?": "+r:""))}):""),n.a.createElement("div",{"data-field":e,className:"select-widget form-elem","data-value":void 0===r?"":r},s?s.map((t,s)=>{let o=t.label,c=t.desc;const l=i&&0==s;l&&(t.desc=this.state.customText);const d=JSON.stringify(t);let m=r.desc===t.desc?"option selected":"option";return m+=l?" custom":"",n.a.createElement("div",{key:s,className:m,"data-value":d,onClick:this.onClick.bind(this)},l?n.a.createElement(n.a.Fragment,null,n.a.createElement("label",null,o),c?n.a.createElement("div",{className:"option-desc desc"},c):"",n.a.createElement("textarea",{name:a+"Custom",className:"form-elem",value:this.state.customText,onChange:this.onChangeCustom.bind(this)})):n.a.createElement(I,{strings:t,fieldKey:e}))}):""))}}var q=J;const V=a(131);class W extends n.a.Component{constructor(e){super(e),this.state={blocks:[],blockMedia:[],superIndex:0}}componentDidUpdate(){const e=this,t=this.props.setKey,a=this.props.fieldKey,s=this.props.fieldValue;s&&s!=this.state.blocks&&(s.map((n,r)=>{if(s[r].index=r,"media"===a){e.state.blockMedia[r]||this.getMediaData(n,t,r)}}),this.setState({blocks:s,superIndex:s.length}))}onChange(e){const t=e.target,a=t.name,s=t.value,n=a.split("_"),r=n[0],i=n[1],o=n[2],c=[r,i].join("_"),l=Number(t.parentElement.parentElement.dataset.index);let d=this.state.blocks,m=d[l];m[o]=s,"media"===i&&"url"===o&&this.getMediaData(m,r,l),this.setState({blocks:d}),this.props.onChange(c,d)}onPsuedoChange(e){}getMediaData(e,t,a){const s=e.source;let n,r=this.state.blocks,i=r[a],o=this.state.blockMedia,c=Object.assign({},o,this.props.blockMedia),l=e.url;if(l)if("image"==s)o[a]={url:l||null,source:"image"},this.setState({blockMedia:o}),c[t]=o,this.props.sendMediaData(c);else{switch(l=encodeURI(l),s){case"youtube":n="https://noembed.com/embed?url="+l;break;case"vimeo":n="https://vimeo.com/api/oembed.json?url="+l;break;case"soundcloud":n="https://soundcloud.com/oembed?format=json&url="+l;break;case"instagram":n="https://api.instagram.com/oembed/?url="+l;break;default:n=null}const e=new Headers;fetch(n,{method:"GET",headers:e,mode:"cors",cache:"default"}).then(e=>{if(this.setState({blockMedia:o}),c[t]=o,this.props.sendMediaData(c),!e.ok)throw o[a]={source:s,loaded:!1},r[a]=i,this.setState({blocks:r,blockMedia:o}),new Error(e.statusText);return e.json()}).then(e=>{let n={source:s,loaded:!0};switch(s){case"instagram":n.url=e.thumbnail_url,n.width=e.thumbnail_width,n.height=e.thumbnail_height,i.caption||(i.caption=e.title),i.credit||(i.credit="@"+e.author_name+" on Instagram"),r[a]=i,this.setState({blocks:r});break;default:n.html=e.html,n.width=e.width,n.height=e.height}o[a]=n,this.setState({blockMedia:o}),c[t]=o,this.props.sendMediaData(c)}).catch((function(e){console.warn(e)}))}}renderBlocks(){let e=[];return this.state.blocks.forEach((t,a)=>{t&&!t.deleted&&e.push(this.renderBlock(t,a))}),e}renderBlock(e,t){e.index=t;const a=this.state.blocks,s=this.props.setKey,r=this.props.fieldKey,i=this.props.field,o=i.fields,c=Object.keys(o);if(!i.types)return null;const l=i.types[e.source];if(!l)return null;l.slug=V(l.label,{lower:!0}),l.name=[s,r,"source"].join("_");let d=[];c.map((a,s)=>{const n=o[a],r=e[a];d.push(this.renderField(a,n,r,l,t,s))});const m=t-1,h=t+1;return n.a.createElement("div",{className:"block-widget","data-slug":e.sourceSlug,"data-index":t,key:e.index},n.a.createElement("input",{name:l.name,type:"hidden",value:l.slug,onChange:this.onPsuedoChange.bind(this)}),d,n.a.createElement("div",{className:"widget-buttons"},m>=0?n.a.createElement("button",{"data-dir":"up","data-new-index":m,className:"widget-button move-block",onClick:this.moveBlock.bind(this)}):"",h<a.length?n.a.createElement("button",{"data-dir":"down","data-new-index":h,className:"widget-button move-block",onClick:this.moveBlock.bind(this)}):"",n.a.createElement("button",{className:"widget-button delete-block",onClick:this.deleteBlock.bind(this)})))}renderField(e,t,a,s,r,i){const o=this.props.setKey,c=this.props.fieldKey,l=(this.props.data,[o,c,e,r].join("_"));let d;return d="url"==e?s:Object.assign({},t.strings),n.a.createElement("div",{className:"field",key:i},n.a.createElement(I,{strings:d,fieldKey:c}),"text"==t.type?n.a.createElement("input",{name:l,className:"form-elem",type:"text",value:a||"",placeholder:d.placeholder,onChange:this.onChange.bind(this)}):null,"textarea"==t.type?n.a.createElement("textarea",{name:l,className:"form-elem",rows:"2",value:a||"",placeholder:d.placeholder,onChange:this.onChange.bind(this)}):null)}renderButtons(){const e=this.props.field.types;if(!e)return;let t=[];return Object.keys(e).map((a,s)=>{let n=e[a];const r=this.renderButton(n,a,s);t.push(r)}),t}renderButton(e,t,a){return n.a.createElement("button",{key:a,className:"button add-block","data-slug":t,onClick:this.addBlock.bind(this)},e.label)}addBlock(e){e.preventDefault();const t=[this.props.setKey,this.props.fieldKey].join("_"),a=this.state.blocks.concat([{source:e.target.dataset.slug,index:this.state.superIndex}]),s=this.state.blockMedia.concat([{source:e.target.dataset.slug,index:this.state.superIndex}]);this.setState({blocks:a,blockMedia:s,superIndex:this.state.superIndex}),this.props.onChange(t,a),this.props.sendActiveCorner(this.props.setKey)}deleteBlock(e){e.preventDefault();this.state.blocks;const t=this.props.setKey,a=this.props.fieldKey,s=e.target.parentElement.parentElement,n=Number(s.dataset.index),r=[t,a].join("_"),i=this.state.blocks.filter((e,t)=>t!==n),o=this.state.blockMedia.filter((e,t)=>t!==n);this.setState({blocks:i,blockMedia:o}),this.props.onChange(r,i),this.props.sendActiveCorner(t);let c=Object.assign({},this.props.mediaData);c[t]=o,this.props.sendMediaData(c)}moveBlock(e){e.preventDefault();const t=this.props.setKey,a=[t,this.props.fieldKey].join("_"),s=e.target.parentElement.parentElement,n=Number(s.dataset.index),r=e.target.dataset.newIndex;let i=this.state.blocks,o=this.state.blockMedia,c=i.splice(n,1)[0];i.splice(r,0,c);let l=o.splice(n,1)[0];o.splice(r,0,l),this.setState({blocks:i,blockMedia:o}),this.props.onChange(a,i);let d=Object.assign({},this.props.mediaData);d[t]=o,this.props.sendMediaData(d)}render(){const e=this.props.setKey,t=this.props.fieldKey;this.props.field.strings,[e,t].join("_");return n.a.createElement("div",{className:"field"},n.a.createElement("div",{className:"blocks-widget"},this.renderBlocks()),n.a.createElement("div",{className:"buttons-group"},this.renderButtons()))}}var z=W;class G extends n.a.Component{constructor(e){super(e),this.state={value:"",mediaData:[]}}onFocus(e){}onChange(e){const t=e.target,a=t.name,s=t.value;this.props.onChange(a,s)}renderGroup(){const e=this.props.field;if(!e)return;const t=e.fields,a=Object.keys(t);let s=[];return a.map((e,a)=>{const n=t[e],r=this.renderSubField(e,n,a);s.push(r)}),s}renderSubField(e,t,a){const s=this.props.setKey,r=this.props.fieldKey,i=t.style,o=t.strings,c=[s,r,e].join("_");return n.a.createElement("div",{className:"field input "+i,key:a},n.a.createElement(I,{strings:o,fieldKey:e}),n.a.createElement("input",{name:c,type:"text",defaultValue:t.default?o.placeholder:"",placeholder:t.placeholder,className:"form-elem",onFocus:this.onFocus.bind(this),onChange:this.onChange.bind(this)}))}render(){const e=this.props.setKey,t=(this.props.fieldKey,this.props.field.strings);return n.a.createElement("div",{className:"field fields-group"},this.props.hideLabel?"":n.a.createElement(I,{strings:t,setKey:e}),this.renderGroup())}}var Q=G;class X extends n.a.Component{constructor(e){super(e)}onChange(e){const t=e.target.name,a=e.target.checked;this.props.onChange(t,a)}render(){const e=this.props,t=e.fieldKey,a=e.field.strings,s=e.field.style,r=[e.setKey,t].join("_");return n.a.createElement("div",{className:"field checkbox "+(s||"")},n.a.createElement("div",{className:"checkbox-widget"},n.a.createElement("input",{className:"toggle",id:t,name:r,type:"checkbox",onChange:this.onChange.bind(this)}),n.a.createElement("label",{className:"checkbox",htmlFor:t},n.a.createElement("div",{className:"label-inner"},a&&a.label?n.a.createElement("span",null,a.label):""))),a&&a.desc?n.a.createElement("div",{className:"desc"},a.desc):"")}}var Y=X;class Z extends n.a.Component{constructor(e){super(e),this.state={value:"",values:{},checked:null,mediaData:[]}}componentDidUpdate(){const e=this.props.fieldValue;e!=this.state.value&&this.setState({value:e,values:{fieldValue:e},checked:e?e.type:null})}onChange(e,t){this.state.formData;const a=e.split("_");a[0],a[1];let s=a[2],n=a[3],r=[a[0],a[1]].join("_"),i=Object.assign({},this.state.value);i.length||(i.type=s),"object"==typeof t?i=Object.assign(i,t):i[n]=t;let o=Object.assign({},this.state.values);o[s]=i,this.setState({values:o,value:i,checked:s}),this.props.onChange(r,i)}onToggle(e){const t=this.state.checked,a=e.target,s=a.checked;let n,r,i=a.id,o=(a.name,i.split("_")[2]);t!=o&&s&&(n=o,r=this.state.values[o]),this.setState({checked:n,value:r}),s?this.onChange(i,r):(i=i.substr(0,i.lastIndexOf("_")),this.props.onChange(i,r))}renderCheckboxes(){const e=this.props.field;if(!e)return;const t=e.fields,a=Object.keys(t);let s=[];return a.map((e,n)=>{const r=t[a],i=this.renderCheckbox(e,r,n);s.push(i)}),s}renderCheckbox(e,t,a){const s=this.props.setKey,r=this.props.fieldKey,i=this.props.field.fields[e].strings,o=([s,r].join("_"),[s,r,"type"].join("_")),c=[s,r,e].join("_"),l=this.state.checked;return n.a.createElement("div",{className:"field checkbox half",key:a},n.a.createElement("div",{className:"checkbox-widget"},n.a.createElement("input",{className:"toggle",id:c,name:o,type:"checkbox",checked:l==e,onChange:this.onToggle.bind(this)}),n.a.createElement("label",{className:"checkbox",htmlFor:c},n.a.createElement("div",{className:"label-inner"},i&&i.label?n.a.createElement("span",null,i.label):""))))}renderFields(){const e=this.props.field;if(!e)return;const t=e.fields,a=Object.keys(t);let s=[];return a.map((e,a)=>{const n=t[e],r=this.renderField(e,n,a);s.push(r)}),s}renderField(e,t,a){const s=this.props.setKey,r=this.props.fieldKey,i=this.props.field.fields[e],o=i.strings,c=([s,e].join("_"),[r,e].join("_")),l="field-toggle-field"+(this.state.checked==e?" active":"");let d,m=this.props.fieldValue;switch(i.type){case"text":d=n.a.createElement(R,{key:a,setKey:s,fieldKey:c,field:i,fieldValue:m,hideLabel:!0,onChange:this.onChange.bind(this)});break;case"textarea":d=n.a.createElement(U,{key:a,setKey:s,fieldKey:c,field:i,fieldValue:m,hideLabel:!0,onChange:this.onChange.bind(this)});break;case"select":d=n.a.createElement(q,{key:a,setKey:s,fieldKey:c,field:i,fieldValue:m,hideLabel:!0,onChange:this.onChange.bind(this)});break;case"group":d=n.a.createElement(Q,{key:a,setKey:s,fieldKey:c,field:i,fieldValue:m,hideLabel:!0,onChange:this.onChange.bind(this),sendMediaData:this.props.sendMediaData})}return n.a.createElement("div",{className:l,key:a},o&&o.desc?n.a.createElement("div",{className:"desc",dangerouslySetInnerHTML:{__html:o.desc}}):"",d)}render(){const e=this.props.id,t=this.props.field.strings;[this.props.setKey,e].join("_");return n.a.createElement("div",{className:"field field-toggle"},n.a.createElement(I,{strings:t,fieldId:e}),n.a.createElement("div",{className:"field-toggle-checkboxes"},this.renderCheckboxes()),n.a.createElement("div",{className:"field-toggle-fields"},this.renderFields()))}}var $=Z;class ee extends n.a.Component{constructor(e){super(e),this.state={expand:!1}}onToggle(e){const t=this.props.setKey,a=t==this.props.activeFieldset?null:t;a&&this.props.sendActiveCorner(a),this.props.sendActiveFieldset(a)}renderFields(){const e=this.props.formData,t=this.props.data.fields,a=Object.keys(t),s=[];for(let r of a){const a=t[r],i=this.props.setKey,o=s.length;let c=e[i]?e[i][r]:null;switch(a.type){case"text":s.push(n.a.createElement(R,{key:o,setKey:i,fieldKey:r,field:a,onChange:this.props.onChange}));break;case"textarea":s.push(n.a.createElement(U,{key:o,setKey:i,fieldKey:r,field:a,onChange:this.props.onChange}));break;case"checkbox":s.push(n.a.createElement(Y,{key:o,setKey:i,fieldKey:r,field:a,onChange:this.props.onChange}));break;case"select":s.push(n.a.createElement(q,{key:o,setKey:i,fieldKey:r,field:a,fieldValue:c,onChange:this.props.onChange}));break;case"blocks":s.push(n.a.createElement(z,{key:o,setKey:i,fieldKey:r,field:a,fieldValue:c,onChange:this.props.onChange,sendActiveCorner:this.props.sendActiveCorner,sendMediaData:this.props.sendMediaData}));break;case"group":s.push(n.a.createElement(Q,{key:o,setKey:i,fieldKey:r,field:a,onChange:this.props.onChange,sendMediaData:this.props.sendMediaData}));break;case"toggle":s.push(n.a.createElement($,{key:o,setKey:i,fieldKey:r,field:a,fieldValue:c,onChange:this.props.onChange,sendMediaData:this.props.sendMediaData}))}}return s}render(){const e=this.props.data,t=this.props.setKey,a=e.strings,s=t===this.props.activeFieldset;return n.a.createElement("fieldset",{id:t,className:"toggler "+(s?"expand":"collapse")},n.a.createElement("legend",{className:"toggle-label corner-label",onClick:this.onToggle.bind(this)},n.a.createElement("div",{className:"corner-icon"}),n.a.createElement("div",{className:"toggle-text"},a.title),n.a.createElement("div",{className:"toggle-icon"})),n.a.createElement("div",{className:"fieldset-inner"},a.desc?n.a.createElement("div",{className:"fieldset-desc desc"},a.desc):"",this.renderFields()))}}var te=ee;const ae=a(131);class se extends n.a.Component{constructor(e){super(e),this.state={lang:v.language,mediaData:this.props.mediaData,formData:{authorship:{},backstory:{},imagery:{},links:{},opts:{},photo:{}}},this.strings=this.props.creator.strings}componentDidMount(){}componentWillUnmount(){}componentDidUpdate(e,t,a){this.props.formData!=this.state.formData&&this.setState({formData:this.props.formData})}onFocus(e){const t=e.target.name.split("_")[0];this.props.sendActiveCorner(t),this.props.sendActiveFieldset(t)}onBlur(e){}onChange(e,t){const a=this.state.formData,s=e.split("_"),n=s[0],r=s[1],i=s[2];i?(a[n][r]||(a[n][r]={}),a[n][r][i]=t):a[n][r]=t,this.setState({formData:a}),this.props.sendFormData(a)}onToggle(e){}onError(e){}renderSchema(){let e=[];this.state.lang;const t=Object.keys(K),a=this.strings;if(a){for(let s of t){const t=K[s].fields,r=Object.keys(t);K[s].strings={title:a[[s,"title"].join("_")],desc:a[[s,"desc"].join("_")]};for(let e of r){let n=t[e];if(n)if(K[s].fields[e].strings={label:a[[s,e,"label"].join("_")],desc:a[[s,e,"desc"].join("_")],placeholder:a[[s,e,"placeholder"].join("_")]},"select"===n.type){const t=a[[s,e,"options"].join("_")];K[s].fields[e].options=t}else if("checkbox"===n.type){if(n.fields&&n.fields.length){K[s].fields[e].options={};for(let t of n.fields)K[s].fields[e].options[t]={label:a[[s,e,t,"label"].join("_")],desc:a[[s,e,t,"desc"].join("_")]}}}else if("blocks"===n.type){const t="types",n=K[s].fields[e].fields,r=Object.keys(n);for(let i of r){const r=n[i],o=a[[s,e,"types"].join("_")];if(K[s].fields[e][t]={},o)for(let a of o){let n=a.slug||ae(a.label,{lower:!0});K[s].fields[e][t][n]=a}if(K[s].fields[e].fields[i].strings={label:a[[s,e,i,"label"].join("_")],placeholder:a[[s,e,i,"placeholder"].join("_")],desc:a[[s,e,i,"desc"].join("_")]},"select"==r.type){const t=a[[s,e,i,"options"].join("_")];K[s].fields[e].fields[i].options=t}}}else if("toggle"===n.type){const t=K[s].fields[e].fields,n=Object.keys(t);for(let r of n){const n=t[r];if(K[s].fields[e].fields[r].strings={label:a[[s,e,r,"label"].join("_")],placeholder:a[[s,e,r,"placeholder"].join("_")],desc:a[[s,e,r,"desc"].join("_")]},"group"===n.type){const t=this.buildGroup(K,s,e,r);K[s].fields[e].fields[r].fields=t}else if("select"===n.type){const t=a[[s,e,r,"options"].join("_")];K[s].fields[e].fields[r].options=t}}}else if("group"===n.type){const t=this.buildGroup(K,s,e);K[s].fields[e].fields=t}}e.push(n.a.createElement(te,{key:s,setKey:s,data:K[s],formData:this.state.formData,imgLoaded:this.props.imgLoaded,onChange:this.onChange.bind(this),activeCorner:this.props.activeCorner,activeFieldset:this.props.activeFieldset,sendActiveCorner:this.props.sendActiveCorner,sendActiveFieldset:this.props.sendActiveFieldset,sendMediaData:this.props.sendMediaData}))}return e}}buildGroup(e,t,a,s){let n=[t,a].join("_"),r=e[t].fields[a].fields;s&&(r=r[s].fields,n=[n,s].join("_"));const i=this.strings,o=Object.keys(r);for(let e of o)r[e].strings={label:i[[n,e,"label"].join("_")],placeholder:i[[n,e,"placeholder"].join("_")],desc:i[[n,e,"desc"].join("_")]};return r}render(){return n.a.createElement("div",{className:"col-inner"},n.a.createElement("div",{id:"forms",className:"col-content"},n.a.createElement("div",{className:"content-block",dangerouslySetInnerHTML:{__html:this.props.creator.post_content}}),n.a.createElement("form",null,this.renderSchema())))}}var ne=se,re=(a(203),a(550),a(37)),ie=a.n(re);class oe extends n.a.Component{constructor(e){super(e)}createLink(e,t,a=[]){return t||(t=this.extractRootDomain(e)),e.indexOf("@")>-1&&(e="mailto:"+e),n.a.createElement("a",{href:e,target:"_blank",className:a.join(" ")},t)}extractHostname(e){let t;return!!e&&(t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t)}extractRootDomain(e){if(!e)return!1;let t=this.extractHostname(e),a=t.split("."),s=a.length;return s>2&&(t=a[s-2]+"."+a[s-1],2==a[s-2].length&&2==a[s-1].length&&(t=a[s-3]+"."+t)),t}render(){const e=this.props.panelData,t=e.license&&"copyright"==e.license.type;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"fc-row"},e.caption?n.a.createElement("div",{className:"fc-field","data-fc-field":"caption"},n.a.createElement("em",null,e.caption)):"",t||e.credit?n.a.createElement("div",{className:"fc-field","data-fc-field":"credit"},n.a.createElement("div",{className:"fc-content"},t?n.a.createElement("div",{className:"fc-copyright"},null!=e.license.year?n.a.createElement("span",null,e.license.year):"",n.a.createElement("span",null,e.credit?e.credit:"",e.license.holder?(e.credit?"/":"")+e.license.holder:"")):n.a.createElement("span",null,e.credit))):"",e.license&&e.license.label&&"commons"==e.license.type?n.a.createElement("div",{className:"fc-field","data-fc-field":"license"},n.a.createElement("span",{className:"fc-label"},"License"),n.a.createElement("span",{className:"fc-content"},e.license.url?n.a.createElement("a",{href:e.license.url,target:"_blank"},e.license.label?e.license.label:""):e.license.label?e.license.label:"")):"",e.ethics&&e.ethics.desc?n.a.createElement("div",{className:"fc-field","data-fc-field":"ethics"},n.a.createElement("span",{className:"fc-label"},"Code of ethics"),n.a.createElement("span",{className:"fc-content"},e.ethics.desc)):"",e.bio?n.a.createElement("div",{className:"fc-field","data-fc-field":"bio"},n.a.createElement("span",{className:"fc-label"},"Bio"),n.a.createElement("div",{className:"fc-content"},e.bio)):"",e.website||e.contact?n.a.createElement("div",{className:"fc-field fc-contact"},e.website?n.a.createElement("div",{className:"fc-field","data-fc-field":"website"},n.a.createElement("div",{className:"fc-label"},"Website"),n.a.createElement("div",{className:"fc-content"},this.createLink(e.website))):"",e.contact?n.a.createElement(n.a.Fragment,null,e.contact.info?n.a.createElement("div",{className:"fc-field","data-fc-field":"contact-info"},n.a.createElement("div",{className:"fc-label"},"For more info contact"),n.a.createElement("div",{className:"fc-content"},this.createLink(e.contact.info))):"",e.contact.rights?n.a.createElement("div",{className:"fc-field","data-fc-field":"contact-rights"},n.a.createElement("div",{className:"fc-label"},"For reproduction rights contact"),n.a.createElement("div",{className:"fc-content"},this.createLink(e.contact.rights))):""):""):""))}}var ce=oe;class le extends n.a.Component{constructor(e){super(e)}renderMedia(e,t){const a=this.props.mediaData;if(a&&a[t]){if("image"==e.source)return e.url?n.a.createElement("div",{className:"fc-media"},n.a.createElement("img",{src:e.url})):"";{const e=a[t].html;return e?n.a.createElement("div",{className:"fc-media",dangerouslySetInnerHTML:{__html:e}}):""}}}renderBackstory(e){const t=e.text,a=t?t.split(/\n/g):[];let s=[];return s.push(a?n.a.createElement("div",{className:"fc-row",key:-1},a.map((e,t)=>e?n.a.createElement("p",{key:t},e):n.a.createElement("br",{key:t}))):""),e.media&&e.media.map((e,t)=>{s.push(n.a.createElement("div",{className:"fc-row",key:t},this.renderMedia(e,t),e.caption?n.a.createElement("div",{className:"fc-sub-caption"},e.caption):"",e.credit?n.a.createElement("div",{className:"fc-sub-credit"},e.credit):""))}),s}render(){const e=this.props.panelData;return n.a.createElement(n.a.Fragment,null,e?this.renderBackstory(e):"")}}var de=le;const me=e=>{if(!e)return!1;let t=(e=>{let t;return!!e&&(t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0],t=t.split("?")[0],t)})(e),a=t.split("."),s=a.length;return s>2&&(t=a[s-2]+"."+a[s-1],2==a[s-2].length&&2==a[s-1].length&&(t=a[s-3]+"."+t)),t};class he extends n.a.Component{constructor(e){super(e)}renderMedia(e,t){const a=this.props.mediaData;if(!a)return;const s=a[t];if(!s)return;let r,i="fc-media";if("image"==s.source||"instagram"==s.source){const e=s.url;return e?n.a.createElement("div",{className:i},n.a.createElement("img",{src:e})):""}{if(Number.isInteger(s.width,s.height)){i+=" fc-responsive",r={paddingBottom:100*(s.height/s.width)+"%"}}let e=s.html?n.a.createElement("div",{className:i,style:r,dangerouslySetInnerHTML:{__html:s.html}}):n.a.createElement(n.a.Fragment,null);return e||""}}renderImagery(e){const t=this.props.mediaData;let a=[];return e.map((e,s)=>{const r=this.renderMedia(e,s),i=["instagram","youtube","vimeo"].includes(e.source),o=t?t[s]:null,c=!!o&&o.loaded;(e.url||e.caption||e.credit)&&a.push(n.a.createElement("div",{className:"fc-row",key:s},r,e.caption?n.a.createElement("div",{className:"fc-sub-caption"},e.caption):"",e.credit||i?n.a.createElement("div",{className:"fc-sub-credit"},c&&i&&e.url?n.a.createElement("a",{href:e.url,target:"_blank"},e.credit||"View on "+me(e.url)):e.credit):""))}),a}render(){const e=this.props.panelData;return n.a.createElement(n.a.Fragment,null,e&&e.media?this.renderImagery(e.media):"")}}var pe=he;class ue extends n.a.Component{constructor(e){super(e)}createLink(e,t,a=[]){return t||(t=me(e)),e&&e.indexOf("@")>-1&&(e="mailto:"+e),n.a.createElement("a",{href:e,target:"_blank",className:a.join(" ")},t)}renderLinks(e){let t=[];return e.forEach((e,a)=>{const s=me(e.url),r=e.url||e.title?n.a.createElement(n.a.Fragment,null,n.a.createElement("span",null,e.title?e.title:s),n.a.createElement("div",{className:"fc-sub-url"},s)):"";t.push(n.a.createElement("div",{className:"fc-row",key:a},this.createLink(e.url,r,["fc-card"])))}),t}render(){const e=this.props.panelData.links;return n.a.createElement(n.a.Fragment,null,e?this.renderLinks(e):"")}}var ge=ue;class fe extends n.a.Component{constructor(e){super(e),this.corners=["imagery","links","authorship","backstory"],this.rtlLangs=["ar","arc","fa","he","ks","kv","ur","yi"],this.state={lang:v.language,formData:{},expandPanel:!1}}componentDidMount(){new FourCorners({selector:".saved-states .fc-embed"})}componentDidUpdate(e,t,a){}onChangeOpts(e){let t={formData:this.props.formData};t[e.target.id]=e.target.checked,this.setState(t)}onClick(e){this.props.sendActiveFieldset("photo")}onFocus(e){e.target.setSelectionRange(0,e.target.value.length)}onBlur(e){}onError(e){console.warn("Error",e)}onScroll(e){}openPanel(e){const t=e.target.dataset.fcSlug;this.props.sendActiveCorner(t),this.setState({expandPanel:!1})}toggleExpandPanel(){this.setState({expandPanel:!this.state.expandPanel})}collapsePanel(){this.props.sendActiveCorner(null),this.setState({expandPanel:!1})}renderPanels(){const e=Object.entries(this.props.formData),t={};e.map(e=>this.corners.includes(e[0])?t[e[0]]=e[1]:"");const a=[],s=this.props.creator;return Object.entries(t).forEach((e,t)=>{const r=e[0],i=[r,"title"].join("_"),o=e[1];let c="";if(Object.keys(o).length)switch(r){case"authorship":c=n.a.createElement(ce,{panelData:o});break;case"backstory":c=n.a.createElement(de,{panelData:o,mediaData:this.props.mediaData.backstory});break;case"imagery":c=n.a.createElement(pe,{panelData:o,mediaData:this.props.mediaData.imagery});break;case"links":c=n.a.createElement(ge,{panelData:o})}const l=s&&s.strings?s.strings[i]:"&nbsp;";let d="fc-panel fc-"+r;this.props.activeCorner===r&&(d+=" fc-active"),a.push(n.a.createElement("div",{className:d,"data-fc-slug":r,key:t},n.a.createElement("div",{className:"fc-panel-title"},l,n.a.createElement("div",{className:"fc-icon fc-expand",onClick:this.toggleExpandPanel.bind(this)}),n.a.createElement("div",{className:"fc-icon fc-close",onClick:this.collapsePanel.bind(this)})),n.a.createElement("div",{className:"fc-panel-title fc-pseudo"},l),c?n.a.createElement("div",{className:"fc-scroll"},n.a.createElement("div",{className:"fc-inner"},c)):""))}),a}renderCorners(){const e=[];return this.corners.forEach((t,a)=>{let s="fc-corner fc-"+t;this.props.activeCorner===t&&(s+=" fc-active"),e.push(n.a.createElement("div",{key:a,className:s,"data-fc-slug":t,onClick:this.openPanel.bind(this)}))}),e}renderCutline(){const e=this.props.formData;if(!e)return;const t=e.opts;return t&&(t.caption||t.credit||t.logo)?n.a.createElement("div",{className:"fc-cutline"},t.caption&&e.authorship?n.a.createElement("span",{className:"fc-caption"},e.authorship.caption):"",t.credit&&e.authorship?n.a.createElement("span",{className:"fc-credit"},e.authorship.credit?n.a.createElement("span",null,e.authorship.credit):"",e.authorship.license&&e.authorship.license.holder?n.a.createElement("span",null,e.authorship.license.holder):""):"",t.logo?n.a.createElement("a",{href:"https://fourcornersproject.org",target:"_blank"}):""):void 0}render(){const e=this.state.lang,t=this.props.formData,a=t.photo?t.photo.src:null,s=t.opts;let r="fc-embed",i="ltr";s&&s.dark&&(r+=" fc-dark"),this.state.expandPanel&&(r+=" fc-full"),r+=a?" fc-loaded":" fc-empty",this.rtlLangs.includes(e)&&(i="rtl");const o=this.props.activeCorner;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:r,"data-fc-active":this.corners.includes(o)?o:"",lang:e,dir:i},a?n.a.createElement("div",{className:"fc-photo fc-loaded"},n.a.createElement("img",{src:a,className:"fc-img"})):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"no-photo"},n.a.createElement("div",{className:"no-photo-text"},n.a.createElement("h2",null,"No photo added"),n.a.createElement("h4",null,'Add a link to your image file under "Add your photo"'))),n.a.createElement("div",{className:"fc-photo"})),this.renderCorners(),this.renderPanels()),this.renderCutline())}}var ve=fe;class be extends n.a.Component{constructor(e){super(e),this.state={includeCss:!1,includeJs:!1,expand:!1},this.imgInputRef=n.a.createRef(),this.outputRef=n.a.createRef(),this.includeJSRef=n.a.createRef(),this.includeCSSRef=n.a.createRef()}componentDidMount(){}componentWillUnmount(){}onChangeOpts(e){let t={formData:this.props.formData};"checkbox"==e.target.type&&(t[e.target.name]=e.target.checked),this.setState(t)}onFocus(e){e.target.setSelectionRange(0,e.target.value.length)}onBlur(e){}onError(e){console.warn("Error",e)}onToggle(e){e.preventDefault();let t=e.currentTarget.parentElement.id;t==this.state.expand&&(t=null),this.setState({expand:t})}embedCode(e){this.props.imgLoaded;let t={lang:v.language},a=e.photo?e.photo.src:null,s=JSON.parse(JSON.stringify(Object.assign(e,t),{}));return s.photo&&delete s.photo.src,"<div class='fc-embed' data-fc='"+this.sanitizeCode(s)+"'>"+(e.photo&&a?"<img class='fc-img' src='"+a+"'/>":"")+"</div>"}sanitizeCode(e){const t=this;let a=JSON.parse(JSON.stringify(e));return Object.keys(a).forEach((function(e){const s=a[e];"object"==typeof s&&Object.keys(s).forEach((function(n){"string"==typeof s[n]?a[e][n]=t.sanitizeString(s[n]):s[n]instanceof Array&&s[n].forEach((function(s,r){Object.keys(s).forEach((function(i){a[e][n][r][i]=t.sanitizeString(s[i])}))}))}))})),JSON.stringify(a)}sanitizeString(e){return"string"!=typeof e?e:e.replace(/'/g,"&apos;").replace(/"/g,'"').replace(/&quot;/g,'"').replace(/“/g,"&ldquo;").replace(/”/g,"&rdquo;").replace(/′/g,"&prime;").replace(/″/g,"&Prime;")}render(){const e=this.props.creator,t=this.props.imgLoaded?"has-image":"";return n.a.createElement("div",{className:"col-inner"},n.a.createElement("div",{className:"col-content"},n.a.createElement("div",{id:"preview",className:t},n.a.createElement(ve,{creator:e,formData:this.props.formData,imgLoaded:this.props.imgLoaded,mediaData:this.props.mediaData,activeCorner:this.props.activeCorner,activeFieldset:this.props.activeFieldset,sendActiveCorner:this.props.sendActiveCorner,sendActiveFieldset:this.props.sendActiveFieldset}),n.a.createElement("div",{id:"embed-output"},n.a.createElement("form",{name:"embed",onChange:this.onChangeOpts.bind(this)},n.a.createElement("fieldset",{id:"addScripts",className:"toggler "+(this.state.expand?"expand":"collapse")},n.a.createElement("legend",{className:"toggle-label",onClick:this.onToggle.bind(this)},n.a.createElement("div",{className:"toggle-text"},e&&e.strings?e.strings.scripts_title:null),n.a.createElement("div",{className:"toggle-icon"})),n.a.createElement("div",{className:"fieldset-inner"},n.a.createElement("div",{className:"fields-group"},n.a.createElement("div",{className:"field"},e&&e.strings&&e.strings.scripts_desc?n.a.createElement("div",{className:"desc",dangerouslySetInnerHTML:{__html:e.strings.scripts_desc}}):"",n.a.createElement("textarea",{className:"output form-elem",id:"libraries",readOnly:!0,rows:3,value:'<script src="https://cdn.jsdelivr.net/npm/@four-corners/fourcorners.js@0.3.3/dist/fourcorners.min.js" type="text/javascript"><\/script><script type="text/javascript">window.onload=function(){new FourCorners()}<\/script><link href="https://cdn.jsdelivr.net/npm/@four-corners/fourcorners.js@0.3.3/dist/fourcorners.min.css" rel="stylesheet" type="text/css">',onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}))))),n.a.createElement("fieldset",{id:"embedPhoto"},n.a.createElement("legend",null,n.a.createElement("div",{className:"toggle-text"},e&&e.strings?e.strings.embed_title:null)),n.a.createElement("div",{className:"fieldset-inner"},n.a.createElement("div",{className:"fields-group"},n.a.createElement("div",{className:"field"},e&&e.strings&&e.strings.embed_desc?n.a.createElement("div",{className:"desc",dangerouslySetInnerHTML:{__html:e.strings.embed_desc}}):"",n.a.createElement("textarea",{className:"output form-elem",id:"json",readOnly:!0,ref:this.outputRef,rows:3,value:this.embedCode(this.props.formData),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}))))))))))}}var ye=be;class Ee extends n.a.Component{constructor(e){super(e),this.state={activeRow:!1,error:!1}}componentDidUpdate(e,t,a){this.props!=e&&this.setState({error:this.props.error})}onChange(e){this.setState({error:!1})}importCode(e){e.preventDefault();const t=document.getElementsByName("import-code")[0].value;let a;t?(this.props.clearFormData(),this.props.updateFormData(t),a=!1):a="No embed code was added.",this.setState({error:a})}render(){const e=this.props.strings,t=["field","input"];return this.state.error&&t.push("error"),n.a.createElement(n.a.Fragment,null,n.a.createElement("button",{className:"button close-popup",onClick:this.props.closePopup.bind(this)}),n.a.createElement("form",{onSubmit:this.importCode.bind(this)},n.a.createElement("legend",null,e.import_label),n.a.createElement("div",{className:"desc instruct-desc"},m()(e.import_desc)),n.a.createElement("div",{className:t.join(" ")},n.a.createElement("textarea",{name:"import-code",className:"form-elem",rows:6,onChange:this.onChange.bind(this)}),this.state.error?n.a.createElement("div",{className:"desc error-desc"},this.state.error):""),n.a.createElement("div",{className:"buttons-group"},n.a.createElement("button",{className:"button",type:"submit",onClick:this.importCode.bind(this)},e.import_button))))}}var ke=Ee;class Ne extends n.a.Component{constructor(e){super(e),this.state={active:!1,hidden:!1},this.textarea=n.a.createRef()}componentDidMount(){}onFocus(e){const t=e.currentTarget;this.copyHistoryRow(t)}onClickRow(e){e.currentTarget.dataset.time;const t=!this.state.active;this.setState({active:t})}onClickButton(e){switch(e.preventDefault(),e.currentTarget.dataset.action){case"delete":this.deleteHistoryRow();break;case"copy":this.copyHistoryRow();break;case"import":this.importHistoryRow()}}deleteHistoryRow(){const e=localStorage.getItem("FourCornersHistory");try{const t=JSON.parse(e),a=this.props.timestamp;if(t[a]){delete t[a];const e=JSON.stringify(t);localStorage.setItem("FourCornersHistory",e),this.setState({hidden:!0})}}catch(e){console.warn(e)}}copyHistoryRow(e){e.setSelectionRange(0,e.value.length)}importHistoryRow(e){const t=this.textarea.current.dataset.value;this.props.timestamp;this.props.clearFormData(),this.props.updateFormData(t)}renderWarning(){}renderEmpty(){return!1}renderModule(e,t){e=Object.assign({},e);const a=t?t.src:null,s=JSON.stringify(e);return n.a.createElement("div",{className:"fc-embed","data-fc":s},a?n.a.createElement("img",{src:a,className:"fc-img"}):"")}renderRow(){const e=this.props.strings,t=this.props.timestamp,a=this.props.dataObj,s=new Date(Number(t)).toLocaleDateString(this.props.lang,{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),r=a.formData.photo,i=this.renderModule(a.formData,r),o=ie.a.renderToStaticMarkup(i).replace(/&quot;/g,"'"),c=ie.a.renderToStaticMarkup(i);let l="toggler saved-state";return l+=this.state.active?" expand":" collapse",n.a.createElement("div",{key:t,className:l},n.a.createElement("div",{className:"toggle-label","data-time":t,onClick:this.onClickRow.bind(this)},n.a.createElement("div",{className:"toggle-text"},n.a.createElement("strong",null,s)),n.a.createElement("div",{className:"toggle-icon"})),n.a.createElement("div",{className:"saved-inner"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-6"},i),n.a.createElement("div",{className:"col col-6"},n.a.createElement("textarea",{ref:this.textarea,className:"output form-elem",rows:6,readOnly:!0,value:o,"data-value":c,onFocus:this.onFocus.bind(this)}),n.a.createElement("div",{className:"buttons-group"},n.a.createElement("button",{className:"button",type:"submit","data-action":"import",onClick:this.onClickButton.bind(this)},m()(e.history_import)),n.a.createElement("button",{className:"button red",type:"button","data-action":"delete",onClick:this.onClickButton.bind(this)},m()(e.history_delete)))))))}render(){return!this.state.hidden&&this.renderRow()}}var Ce=Ne;class xe extends n.a.Component{constructor(e){super(e),this.state={activeRow:null}}componentDidMount(){}renderWarning(){}renderHistory(){const e=this,t=(e.state.hiddenRows,localStorage.getItem("FourCornersHistory"));let a=JSON.parse(t)||{},s=Object.keys(a).sort((function(e,t){return t-e})),r=[];return s.forEach((function(t,s){e.props.timestamp!=t&&r.push(n.a.createElement(Ce,{key:s,strings:e.props.strings,dataObj:a[t],timestamp:t,lang:e.props.lang,clearFormData:e.props.clearFormData.bind(this),updateFormData:e.props.updateFormData.bind(this)}))})),n.a.createElement("div",{className:"saved-states"},r)}deleteHistory(){const e=localStorage.getItem("FourCornersHistory"),t=JSON.parse(e)||{};this.setState({hiddenRows:Object.keys(t)}),localStorage.removeItem("FourCornersHistory")}render(){const e=this.props.strings,t=localStorage.getItem("FourCornersHistory");return n.a.createElement(n.a.Fragment,null,n.a.createElement("legend",null,e.history_label),n.a.createElement("button",{className:"button close-popup",onClick:this.props.closePopup.bind(this)}),n.a.createElement("div",{className:"desc instruct-desc"},m()(e.history_desc)),t?this.renderHistory():n.a.createElement("h3",null,"There is no edit history found."),n.a.createElement("div",{className:"buttons-group"},n.a.createElement("button",{className:"button",onClick:this.props.toggleSave.bind(this)},this.props.saveHistory?e.history_opt_out:e.history_opt_in),n.a.createElement("button",{className:"button red",onClick:this.deleteHistory.bind(this)},e.history_delete_all)))}}var Se=xe;a(131);class we extends n.a.Component{constructor(e){super(e),this.state={activeDesc:null,activeTab:null},this.strings=this.props.creator.strings||{}}toggleDesc(e){const t=e.currentTarget;let a;a=this.state.activeDesc==t.dataset.tab?null:t.dataset.tab,this.setState({activeDesc:a})}openDesc(e){this.setState({activeDesc:e.currentTarget.dataset.tab})}openPopup(e){this.setState({activeTab:e.currentTarget.dataset.tab})}closePopup(e){this.setState({activeTab:null})}updateFormData(e){const t=this;try{const a=m()(e)[0],s=a.props.children[0],n=a.props["data-fc"];let r=JSON.parse(n);if(s){const e=s.props.src;r=Object.assign(r,{photo:{src:e}})}t.props.sendFormData(r),Object.keys(K).forEach((function(e){const a=K[e];setTimeout((function(){t.updateFieldsData([e],a,r)}),100)})),t.closePopup()}catch(e){t.setState({error:"The embed code is not valid."}),console.warn(e)}}updateFieldsData(e,t,a){const s=this,n=t.fields,r=a[e[0]];r&&Object.keys(n).forEach((function(t){const a=n[t],i=r[t];let o=e.slice(0);switch(o.push(t),a.type){case"text":case"textarea":case"select":case"blocks":s.updateFieldData(o,i)}}))}updateFieldData(e,t){let a,s;switch(typeof t){case"object":Array.isArray(t)&&t.forEach((function(t){const n=t.index;delete t.index,Object.keys(t).forEach((function(r){const i=t[r];let o=e.slice(0);o.push(r,n),a=o.join("_"),s=document.getElementsByName(a)[0],s&&(s.value=i)}))}));break;case"string":a=e.join("_"),s=document.getElementsByName(a)[0],s&&(s.value=t)}}updateFieldValue(){}render(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{id:"embed-import",className:this.state.activeTab?"opened":""},n.a.createElement("div",{id:"popup-links"},n.a.createElement("div",{className:"popup-link"},n.a.createElement("label",null,n.a.createElement("a",{onClick:this.openPopup.bind(this),"data-tab":"import",href:"#"},m()(this.strings.import_label)),n.a.createElement("a",{href:"#",className:"toggle-desc","data-tab":"import",onClick:this.toggleDesc.bind(this)},n.a.createElement("div",null)))),n.a.createElement("div",{className:"popup-link"},n.a.createElement("label",null,n.a.createElement("a",{onClick:this.openPopup.bind(this),"data-tab":"history",href:"#"},m()(this.strings.history_label)),n.a.createElement("a",{href:"#",className:"toggle-desc","data-tab":"history",onClick:this.toggleDesc.bind(this)},n.a.createElement("div",null))))),n.a.createElement("div",{className:"popup-link-descs"},n.a.createElement("div",{className:"desc field-desc"+("import"==this.state.activeDesc?" opened":"")},m()(this.strings.import_desc)),n.a.createElement("div",{className:"desc field-desc"+("history"==this.state.activeDesc?" opened":"")},m()(this.strings.history_desc))),n.a.createElement("div",{id:"creator-popup"},n.a.createElement("div",{id:"popup-back",onClick:this.closePopup.bind(this)}),n.a.createElement("div",{className:"content-block tab-content"+("import"==this.state.activeTab?" opened":"")},n.a.createElement(ke,{strings:this.strings,error:this.state.error,warn:this.state.warn,closePopup:this.closePopup.bind(this),clearFormData:this.props.clearFormData.bind(this),updateFormData:this.updateFormData.bind(this)})),n.a.createElement("div",{className:"content-block tab-content"+("history"==this.state.activeTab?" opened":"")},n.a.createElement(Se,{strings:this.strings,error:this.state.error,warn:this.state.warn,timestamp:this.props.timestamp,saveHistory:this.props.saveHistory,toggleSave:this.props.toggleSave.bind(this),closePopup:this.closePopup.bind(this),clearFormData:this.props.clearFormData.bind(this),updateFormData:this.updateFormData.bind(this)})))))}}var De=we;class _e extends n.a.Component{constructor(e){super(e),this.state={page:siteSettings.current,formData:{authorship:{},backstory:{},imagery:{},links:{},opts:{},photo:{}},mediaData:{imagery:[],backstory:[]},activeCorner:null,activeFieldset:"photo",saveHistory:!0},this.timestamp=Date.now(),this.corners=["imagery","authorship","backstory","links"],this.outputRef=n.a.createRef()}componentDidMount(){const e=localStorage.getItem("FourCornersSettings");let t=JSON.parse(e)||{};const a=t.saveHistory;if("boolean"==typeof a)this.setState({saveHistory:a});else{t.saveHistory=this.state.saveHistory;const e=JSON.stringify(t);localStorage.setItem("FourCornersSettings",e)}v.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}onLanguageChanged(e){this.setState({lang:e})}clearFormData(){this.setState({formData:{}})}setFormData(e){if(!e)return;if(this.setState({formData:e}),!this.state.saveHistory)return;const t=localStorage.getItem("FourCornersHistory"),a=JSON.parse(t)||{};Object.keys(a).sort((function(e,t){return t-e})).forEach((function(e,t){t>=10&&delete a[e]}));let s=a&&"object"==typeof a&&!Array.isArray(a)?a:{};s[this.timestamp]={lang:this.state.lang,dateCreated:new Date,formData:e},localStorage.setItem("FourCornersHistory",JSON.stringify(s))}setMediaData(e){const t=Object.assign(this.state.mediaData,e);this.setState({mediaData:t})}setActiveCorner(e){e||(e=""),this.setState({activeCorner:e})}setActiveFieldset(e=""){this.setState({activeFieldset:e})}toggleSave(){const e=!this.state.saveHistory,t=localStorage.getItem("FourCornersSettings");let a=JSON.parse(t);a.saveHistory=e;const s=JSON.stringify(a);localStorage.setItem("FourCornersSettings",s),this.setState({saveHistory:e})}renderFormCol(){return n.a.createElement(ne,{lang:this.state.lang,creator:this.state.page,formData:this.state.formData,activeCorner:this.state.activeCorner,activeFieldset:this.state.activeFieldset,sendActiveCorner:this.setActiveCorner.bind(this),sendActiveFieldset:this.setActiveFieldset.bind(this),sendFormData:this.setFormData.bind(this),sendMediaData:this.setMediaData.bind(this)})}renderPreviewCol(){return n.a.createElement(ye,{lang:this.state.lang,creator:this.state.page,formData:this.state.formData,mediaData:this.state.mediaData,activeCorner:this.state.activeCorner,activeFieldset:this.state.activeFieldset,sendActiveCorner:this.setActiveCorner.bind(this),sendActiveFieldset:this.setActiveFieldset.bind(this)})}render(){this.state.lang;const e=this.state.page&&this.state.page.ID;return n.a.createElement("main",{id:"creator"},n.a.createElement("div",{className:"max-width"},n.a.createElement("div",{className:"row",id:"head-cols"},n.a.createElement("div",{className:"col col-auto"},n.a.createElement("h2",null,this.state.page.post_title)),n.a.createElement("div",{className:"col"},e?n.a.createElement(De,{lang:this.state.lang,creator:this.state.page,timestamp:this.timestamp,saveHistory:this.state.saveHistory,toggleSave:this.toggleSave.bind(this),clearFormData:this.clearFormData.bind(this),sendFormData:this.setFormData.bind(this)}):"")),n.a.createElement("div",{className:"row",id:"form-cols"},n.a.createElement("div",{className:"col col-12 col-md-6 col-lg-5 left col-form"},e?this.renderFormCol():null),n.a.createElement("div",{className:"col col-12 col-md-6 col-lg-7 right col-preview"},this.renderPreviewCol()))))}}var je=_e;class Fe extends n.a.Component{constructor(e){super(e),this.state={slug:null,page:null}}componentDidMount(){let e=window.location.href.split("/"),t=e.pop()||e.pop();this.getPage(t),v.on("languageChanged",this.onLanguageChanged)}componentWillReceiveProps(e){let t=e.location.pathname.split("/"),a=t.pop()||t.pop();a!==this.state.slug&&(this.setState({slug:null,page:null}),this.getPage(a))}componentWillUnmount(){v.off("languageChanged",this.onLanguageChanged)}onLanguageChanged(e){this.setState({lang:e})}getPage(e){let t=this,a=v.language,s=siteSettings.url.api+"page?slug="+e+"&lang="+a;this.setState({slug:e}),fetch(s).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(e){e&&t.setState({page:e})}))}render(){this.state.lang;const e=this.state.page;return n.a.createElement("main",{id:this.state.slug},e?n.a.createElement("div",{className:"md-width"},n.a.createElement("h1",null,m()(e.post_title)),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col col-12"},n.a.createElement("div",{className:"col-content"},e.post_content?m()(e.post_content):"")))):"")}}var Le=Fe;a(546),a(547);let Oe=Le;switch(siteSettings.template){case"index":Oe=C;break;case"creator":Oe=je;break;case"about":Oe=S;break;case"how":Oe=j;break;case"gallery":Oe=M;break;case"contact":Oe=T}const Me=n.a.createElement(i.a,null,e=>n.a.createElement(o.a,null,n.a.createElement(n.a.Fragment,null,n.a.createElement(c.a,null,n.a.createElement(l.a,{path:"*",component:Oe})))));Object(r.render)(Me,document.getElementById("page"))},92:function(e,t,a){window,e.exports=function(){return a={},e.m=t=[function(e,t,a){e.exports=a(1)},function(e,t,a){function s(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}a(2);var r=function(){function e(t,a){n(this,e),this.cornerSlugs=["authorship","backstory","imagery","links"],this.elems={embed:t};var s=u(this);this.strings={},this.setUpData(s),this.onImgLoad=new Event("onImgLoad"),this.onImgFail=new Event("onImgFail"),this.initModule()}var t,a;return t=e,(a=[{key:"setUpData",value:function(e){this.lang=e&&e.lang?e.lang:"en",this.strings=y[this.lang],this.photo=i(this,e),this.opts=Object.assign(E,this.opts),this.opts=e?Object.assign(this.opts,e.opts):{},this.content={authorship:e?e.authorship:{},backstory:e?e.backstory:{},imagery:e?e.imagery:{},links:e?e.links:{}},this.elems.photo=this.addPhoto(),this.elems.panels=this.addPanels(),this.elems.corners=this.addCorners(),this.elems.media=this.embedMedia(),this.elems.cutline=this.addCutline();var t=this;return Object.keys(this.elems.corners).forEach((function(e,a){var s=t.elems.corners[e];t.opts.static||s.classList.contains("fc-interactive")||(s.addEventListener("mouseenter",t.hoverCorner.bind(t)),s.addEventListener("mouseleave",t.unhoverCorner.bind(t)),s.addEventListener("click",t.clickCorner.bind(t)),s.classList.add("fc-interactive"))})),this}},{key:"initModule",value:function(){var e=this,t=this.elems.embed;t.classList.add("fc-init"),this.opts.dark&&t.classList.add("fc-dark"),this.opts.static?t.classList.add("fc-static"):t.addEventListener("click",(function(t){var a=g(t.target,e.getPanel()),s=g(t.target,e.elems.corners),n=g(t.target,Array.from(document.querySelectorAll("#creator")));a||s||n||(e.closePanel(),e.elems.embed.classList.remove("fc-full"))})),t.lang=this.lang,["ar"].includes(this.lang)?t.dir="rtl":t.dir="ltr",window.addEventListener("resize",this.resizeModule.bind(this)),this.resizeModule()}},{key:"updateModule",value:function(e){return e||u(this),this.setUpData(e),this.initModule(),this}},{key:"getPanel",value:function(e){var t=this.elems.embed;if(t){var a=".fc-panel";return e?(a+='[data-fc-slug="'+e+'"]',t.querySelector(a)):t.querySelectorAll(a)}}},{key:"openPanel",value:function(e){var t=this,a=t.cornerSlugs,s=t.elems.embed,n=t.elems.corners[e],r=t.getPanel(e);s.classList.remove("fc-full"),s&&n&&r&&(s.dataset.fcActive=e,s.classList.add("fc-active"),n.classList.add("fc-active"),r.classList.add("fc-active")),a.forEach((function(a,s){a!=e&&t.closePanel(a)}))}},{key:"closePanel",value:function(e){var t=this.elems.embed;if(e=e||t.dataset.fcActive){var a=this.elems.corners[e],s=this.getPanel(e);e==t.dataset.fcActive&&(t.dataset.fcActive="",t.classList.remove("fc-active")),a&&a.classList.remove("fc-active"),s&&s.classList.remove("fc-active")}}},{key:"toggleExpandPanel",value:function(){this.elems.embed.classList.toggle("fc-full")}},{key:"hoverCorner",value:function(e){e.target.classList.add("fc-hover")}},{key:"unhoverCorner",value:function(e){e.target.classList.remove("fc-hover")}},{key:"clickCorner",value:function(e){var t=e.target.dataset.fcSlug,a=this.elems.embed.dataset.fcActive;t&&(t==a?this.closePanel(t):this.openPanel(t))}},{key:"addCorners",value:function(){var e,t=this,a={},s=this.elems.embed,n=(this.elems.photo,this.opts.active),r=y[this.lang];return this.cornerSlugs.forEach((function(i,o){var c='.fc-corner[data-fc-slug="'+i+'"]',l=r?r[i]:null,d=s.querySelector(c),m=!!d;(d=d||document.createElement("div")).dataset.fcSlug=i,d.title=l?"View "+l:null,d.classList.add("fc-corner"),d.classList.add("fc-"+i),i==n&&d.classList.add("fc-active"),t.content&&((e=t.content[i])&&Object.keys(e).length||d.classList.add("fc-empty")),a[i]=d,m||s.appendChild(d)})),a}},{key:"addPanels",value:function(){var e=this,t={};if(this.elems.embed)return this.cornerSlugs.forEach((function(t,a){var s=e.opts.active,n=e.getPanel(t);n&&n.remove();var r="";if(e.content&&e.content[t]){var i=e.content[t];switch(t){case"authorship":r=c(e,i);break;case"backstory":r=l(e,i);break;case"imagery":r=d(e,i);break;case"links":r=m(e,i)}}var o=e.strings[t],h="fc-panel fc-"+t;t==s&&(h+=" fc-active");var p='<div data-fc-slug="'.concat(t,'" class="').concat(h,'">\n\t\t\t\t\t<div class="fc-panel-title">\n\t\t\t\t\t\t<span>').concat(o,'</span>\n\t\t\t\t\t\t<div class="fc-icon fc-expand" title="Expand this panel"></div>\n\t\t\t\t\t\t<div class="fc-icon fc-close" title="Close this panel"></div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div class="fc-panel-title fc-pseudo">\n\t\t\t\t\t\t<span>').concat(e.cornerSlugs.indexOf(t),"</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t").concat(r?'<div class="fc-scroll">\n\t\t\t\t\t\t<div class="fc-inner">\n\t\t\t\t\t\t\t'.concat(r,"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"):"","\n\t\t\t\t</div>");e.elems.embed.innerHTML+=p})),this.cornerSlugs.forEach((function(a,s){var n=e.getPanel(a);(t[a]=n).querySelector(".fc-expand").addEventListener("click",(function(t){e.toggleExpandPanel()})),n.querySelector(".fc-close").addEventListener("click",(function(t){e.closePanel(a),e.elems.embed.classList.remove("fc-full")}))})),t}},{key:"addPhoto",value:function(){var e,t=this,a=this.elems.embed,s=(this.photo?this.photo.width:null)/(this.photo?this.photo.height:null);a.style.paddingBottom=100/s+"%",(e=a.querySelector(".fc-img"))||a.classList.add("fc-empty");var n=new Image;return a.classList.add("fc-loading"),n.onload=function(e){a.style.paddingBottom="",a.classList.remove("fc-loading"),a.dispatchEvent(t.onImgLoad)},n.onerror=function(e){a.classList.remove("fc-loading"),a.classList.add("fc-empty"),a.dispatchEvent(t.onImgFail)},n.src=e?e.src:null,e}},{key:"addCutline",value:function(){var e=this.content.authorship;if((e||this.opts.caption||this.opts.credit||this.opts.logo)&&this.content.authorship){var t=this.elems.embed,a=this.opts.caption&&e.caption?'<span class="fc-caption">'.concat(e.caption,"</span>"):"",s=this.opts.credit&&(e.credit||e.license.holder)?'<div class="fc-credit">\n\t\t\t\t'.concat((e.credit?"<span>".concat(e.credit,"</span>"):"")+(e.license.holder?"<span>".concat(e.license.holder,"</span>"):""),"\n\t\t\t</div>"):"",n=this.opts.logo?'<a href="https://fourcornersproject.org" target="_blank" class="fc-logo" title="This is a Four Corners photo"></a>':"",r='<div class="fc-cutline">\n\t\t\t\t'.concat(a+s+n,"\n\t\t\t</div>");return t.insertAdjacentHTML("afterend",r),r}}},{key:"embedMedia",value:function(){var e=this,t=this.content.imagery;if(t){var a=t.media;a&&Object.keys(a).forEach((function(t,s){var n=a[t];("image"!=n.source&&n.source?p:h)(e,n,"imagery",s)}))}}},{key:"resizeModule",value:function(){var e=this.getPanel();e&&Object.keys(e).forEach((function(t,a){o(e[t])}))}}])&&s(t.prototype,a),e}(),i=function(e,t){if(t&&t.photo&&t.photo.src)return t.photo;var a=e.elems.embed?e.elems.embed.querySelector("img"):null;return{src:a?a.src:null}},o=function(e){if("function"==typeof e.querySelector){var t=e.querySelector(".fc-scroll");t&&(t.scrollHeight>t.clientHeight?e.classList.add("fc-overflow"):e.classList.remove("fc-overflow"))}},c=function(e,t){var a,s="";s+=t.caption?'<div class="fc-field">\n\t\t\t<em>'.concat(t.caption,"</em>\n\t\t</div>"):"";var n=[];t.license||(t.license={});var r="copyright"==t.license.type;return t.license.year&&n.push("<span>".concat(t.license.year,"</span>")),t.credit&&n.push("<span>".concat(t.license.holder?t.credit+"/"+t.license.holder:t.credit,"</span>")),s+=r||t.credit?'<div class="fc-field" data-fc-field="credit">\n\t\t\t\t<div class="fc-content">\n\t\t\t\t\t'.concat(r?'<div class="fc-copyright">\n\t\t\t\t\t\t\t'.concat(n.join(""),"\n\t\t\t\t\t\t</div>"):"<div>".concat(t.credit,"</div>"),"\n\t\t\t\t</div>\n\t\t\t</div>"):"",s+=t.license&&t.license.label&&"commons"==t.license.type?'<div class="fc-field" data-fc-field="license">\n\t\t\t\t<span class="fc-label">'.concat(e.strings.license,'</span>\n\t\t\t\t<span class="fc-content">\n\t\t\t\t\t').concat(t.license.url?'<a href="'.concat(t.license.url,'" target="_blank">\n\t\t\t\t\t\t').concat(t.license.label?t.license.label:"","\n\t\t\t\t\t</a>"):t.license.label?t.license.label:"","\n\t\t\t\t</span>\n\t\t\t</div>"):"",s+=t.ethics&&t.ethics.desc?'<div class="fc-field" data-fc-field="ethics">\n\t\t\t\t<span class="fc-label">'.concat(e.strings.cod,'</span>\n\t\t\t\t<span class="fc-content">').concat(t.ethics.desc,"</span>\n\t\t\t</div>"):"",s+=t.bio?'<div class="fc-field">\n\t\t\t<span class="fc-label">'.concat(e.strings.bio,"</span>\n\t\t\t").concat(t.bio,"\n\t\t</div>"):"",(s+=t.website||t["0-contact"]||t["1-contact"]?'<div class="fc-field fc-contact">\n\n\t\t\t'.concat(t.website?'<div class="fc-field fc-card">\n\t\t\t\t<div class="fc-label">'.concat(e.strings.website,"</div>\n\t\t\t\t").concat(v(t.website),"\n\t\t\t</div>"):"","\n\n\t\t\t").concat(t["0-contact"]?'<div class="fc-field fc-card">\n\t\t\t\t<div class="fc-label">'.concat(e.strings.info,"</div>\n\t\t\t\t").concat(v(t["0-contact"]),"\n\t\t\t</div>"):"","\n\n\t\t\t").concat(t["1-contact"]?'<div class="fc-field fc-card">\n\t\t\t\t<div class="fc-label">'.concat(e.strings.rights,"</div>\n\t\t\t\t").concat(v(t["1-contact"]),"\n\t\t\t</div>"):"","\n\n\t\t</div>"):"").length&&(a='<div class="fc-row">'.concat(s,"</div>")),a},l=function(e,t){return"".concat(t.text?'<div class="fc-row">\n\t\t\t'.concat(f(t.text),"\n\t\t</div>"):"","\n\t\t").concat(t.media?t.media.map((function(t,a){return p(e,t,"backstory",a),'<div class="fc-row">\n\t\t\t\t<div class="fc-media" data-fc-source="'.concat(t.source,'"></div>\n\t\t\t\t').concat(t.caption?'<div class="fc-sub-caption">'.concat(t.caption,"</div>"):"","\n\t\t\t\t").concat(t.credit?'<div class="fc-sub-credit">'.concat(t.credit,"</div>"):"","\n\t\t\t</div>")})).join(""):"")},d=function(e,t){if(t.media)return"".concat(t.media.map((function(e,t){var a=["instagram","youtube","vimeo"].includes(e.source);return'<div class="fc-row">\n\t\t\t\t<div class="fc-media" data-fc-source="'.concat(e.source,'">\n\t\t\t\t</div>\n\t\t\t\t').concat(e.caption?'<div class="fc-sub-caption">'.concat(e.caption,"</div>"):"","\n\t\t\t\t").concat(e.credit||a?'<div class="fc-sub-credit">\n\t\t\t\t\t\t'.concat(a&&e.url?'<a href="'.concat(e.url,'" target="_blank">'):"","\n\t\t\t\t\t\t\t").concat(e.credit||"View on "+b(e.url),"\n\t\t\t\t\t\t").concat(a?"</a>":"","\n\t\t\t\t\t</div>"):"","\n\t\t\t</div>")})).join(""))},m=function(e,t){if(t.links)return t.links.map((function(e){if(!e||!e.url)return null;var t=b(e.url),a=e.url?"".concat(e.title?e.title:t,'\n\t\t\t<div class="fc-sub-url">').concat(t,"</div>"):"";return'<div class="fc-row">'.concat(v(e.url,a,["fc-card"]),"</div>")})).join("")},h=function(e,t,a,s){if(t.url){var n=new Image;n.onload=function(n){var r='<img src="'.concat(t.url,'"/>');e.elems.panels[a].querySelectorAll(".fc-media")[s].innerHTML+=r},n.src=t.url}},p=function(e,t,a,s){var n="";switch(t.source){case"youtube":n="https://noembed.com/embed?url="+t.url;break;case"vimeo":n="https://vimeo.com/api/oembed.json?url="+t.url;break;case"soundcloud":n="https://soundcloud.com/oembed?format=json&url="+t.url;break;case"instagram":n="https://api.instagram.com/oembed/?url="+t.url;break;default:return!1}var r=new Headers;fetch(n,{method:"GET",headers:r}).then((function(e){if(!e.ok)throw Error(e.statusText);return e.json()})).then((function(n){var r,i=e.elems.panels[a].querySelectorAll(".fc-media")[s];if(r="instagram"==t.source?'<img src="'.concat(n.thumbnail_url,'"/>'):n.html,Number.isInteger(n.width,n.height)){var o=n.height/n.width;i.classList.add("fc-responsive"),i.style.paddingBottom=100*o+"%"}i.innerHTML=r})).catch((function(e){console.warn("Four Corners cannot load this media source: "+t.url,e)}))},u=function(e){if(e.elems&&e.elems.embed){var t=e.elems.embed.dataset.fc;if(t)return delete e.elems.embed.dataset.fc,JSON.parse(t)}},g=function(e,t){var a=!1;return Object.entries(t).forEach((function(t){var s=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var a=[],s=!0,n=!1,r=void 0;try{for(var i,o=e[Symbol.iterator]();!(s=(i=o.next()).done)&&(a.push(i.value),!t||a.length!==t);s=!0);}catch(e){n=!0,r=e}finally{try{s||null==o.return||o.return()}finally{if(n)throw r}}return a}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}(t,2),n=(s[0],s[1]);n&&n.contains&&n.contains(e)&&(a=!0)})),a},f=function(e){var t=e.split(/\n/g);return t?"".concat(t.map((function(e,t){return e?"<p>".concat(e,"</p>"):"<br/>"})).join("")):""},v=function(e,t,a){var s=2<arguments.length&&void 0!==a?a:[];return t=t||b(e),-1<e.indexOf("@")&&(e="mailto:"+e),'<a href="'.concat(e,'" target="_blank" class="').concat(s.join(" "),'">').concat(t,"</a>")},b=function(e){if(!e)return null;var t,a=(t=e)?(-1<t.indexOf("//")?t.split("/")[2]:t.split("/")[0]).split(":")[0].split("?")[0]:null,s=a.split("."),n=s.length;return 2<n&&(a=s[n-2]+"."+s[n-1],2==s[n-2].length&&2==s[n-1].length&&(a=s[n-3]+"."+a)),a},y={en:{authorship:"Authorship",backstory:"Backstory",imagery:"Related Imagery",links:"Links",license:"License",cod:"Code of ethics",bio:"Bio",website:"Website",info:"For more info",rights:"للحصول على حقوق النسخ"},ar:{authorship:"التأليف",backstory:"القصة وراء الصورة ",imagery:"الصور ذات الصلة",links:"الروابط",license:"الترخيص",cod:"ميثاق أخلاقيات",bio:"السيرة الذاتية",website:"الموقع الكتروني",info:"لمزيد من المعلومات",rights:"للحصول على حقوق النسخ"}},E={selector:".fc-embed",static:!1,caption:!1,credit:!1,logo:!1,active:""};e.exports=function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};n(this,e);var a=[];if(t.elem instanceof Element)a=[t.elem];else if(NodeList.prototype.isPrototypeOf(t.elem))a=Array.from(t.elem);else{var s="string"==typeof t.selector?t.selector:".fc-embed";a=Array.from(document.querySelectorAll(s))}var i=[];return a.forEach((function(e,a){var s=new r(e,t);i.push(s)})),i}},function(e,t,a){}],e.c=a,e.d=function(t,a,s){e.o(t,a)||Object.defineProperty(t,a,{enumerable:!0,get:s})},e.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},e.t=function(t,a){if(1&a&&(t=e(t)),8&a)return t;if(4&a&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&a&&"string"!=typeof t)for(var n in t)e.d(s,n,function(e){return t[e]}.bind(null,n));return s},e.n=function(t){var a=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(a,"a",a),a},e.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},e.p="",e(e.s=0);function e(s){if(a[s])return a[s].exports;var n=a[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,e),n.l=!0,n.exports}var t,a}()}});
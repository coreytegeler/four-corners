!function(e){function t(t){for(var s,o,i=t[0],c=t[1],l=t[2],u=0,m=[];u<i.length;u++)o=i[u],r[o]&&m.push(r[o][0]),r[o]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);for(d&&d(t);m.length;)m.shift()();return n.push.apply(n,l||[]),a()}function a(){for(var e,t=0;t<n.length;t++){for(var a=n[t],s=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(s=!1)}s&&(n.splice(t--,1),e=o(o.s=a[0]))}return e}var s={},r={0:0},n=[];function o(t){if(s[t])return s[t].exports;var a=s[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=s,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)o.d(a,s,function(t){return e[t]}.bind(null,s));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i=window.webpackJsonp=window.webpackJsonp||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var d=c;n.push([318,1]),a()}({315:function(e,t){},316:function(e,t,a){},318:function(e,t,a){"use strict";a.r(t);var s=a(0),r=a.n(s),n=a(54),o=a(59),i=a(320),c=a(322),l=a(321),d=a(319),u=a(90),m=a(133),p=a.n(m),h=a(134),g=a.n(h);u.a.use(p.a).use(g.a).use(o.b).init({fallbackLng:"en",debug:!0,react:{wait:!0,bindI18n:"languageChanged loaded",bindStore:"added removed",nsMode:"default"},detection:{order:["path","querystring","cookie","localStorage","navigator","htmlTag","subdomain"],lookupQuerystring:"lang",lookupCookie:"i18n",lookupLocalStorage:"i18nextLng"},backend:{loadPath:SiteSettings.url.api+"{{ns}}/{{lng}}"}});var f=u.a;var b=class extends r.a.Component{constructor(e){super(e),this.state={lang:"en",langs:{}},this.onLanguageChanged=this.onLanguageChanged.bind(this)}componentDidMount(){let e=this,t=(f.language,SiteSettings.url.api+"get_langs");fetch(t).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){e.setState({langs:JSON.parse(t)})}),f.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){f.off("languageChanged",this.onLanguageChanged)}onLanguageChanged(e){this.setState({lang:e})}renderLangList(){const e=this.state.langs;return r.a.createElement("select",{onChange:this.changeLang.bind(this),className:"form-control"},Object.keys(this.state.langs).map(function(t,a){const s=e[t];return r.a.createElement("option",{key:t,value:t},s.name)}))}changeLang(e){console.log(e)}render(){return this.state.lang,r.a.createElement("header",{className:"header"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-sm-6 left"},r.a.createElement("div",{className:"half-max-width"},r.a.createElement("h1",{className:"site-title"},r.a.createElement(d.a,{to:SiteSettings.path},"Four Corners")))),r.a.createElement("div",{className:"col-12 col-sm-6 right"},r.a.createElement("div",{className:"half-max-width"}))))}};var v=a(55),y=a.n(v),E=a(135),C=a.n(E);var S={title:"",type:"object",properties:{copyright:{title:"",type:"object",required:[],properties:{credit:{type:"string"},caption:{type:"string"},copyright:{type:"string",enum:[]},ethics:{type:"string",enum:[]}}},backstory:{title:"",type:"object",required:[],properties:{story:{type:"string"},media:{title:"",type:"array",items:{type:"object",properties:{type:{type:"string",enum:["image","youtube","vimeo","soundcloud"],enumNames:["Image","YouTube","Vimeo","SoundCloud"]},url:{type:"string",format:"uri"},credit:{type:"string"}}}}}},context:{title:"",type:"object",required:[],properties:{story:{type:"string"},media:{title:"",type:"array",items:{type:"object",properties:{type:{type:"string",enum:["image","youtube","vimeo","soundcloud"],enumNames:["Image","YouTube","Vimeo","SoundCloud"]},url:{type:"string",format:"uri"},credit:{type:"string"}}}}}},links:{title:"",type:"object",required:[],properties:{links:{type:"array",minItems:0,items:{type:"object",properties:{title:{type:"string"},url:{type:"string",format:"uri"}}}}}}}};var D={copyright:{caption:{"ui:widget":"textarea","ui:options":{rows:5}},copyright:{"ui:widget":"customSelectWidget"},ethics:{"ui:widget":"customSelectWidget"}},backstory:{story:{"ui:widget":"textarea","ui:options":{rows:5}}},context:{custom:{"ui:widget":"myCustomWidget"},story:{"ui:widget":"textarea","ui:options":{rows:5}}}};var w=function(e,t){return t},N=(a(1),a(6));class k extends r.a.Component{constructor(e){super(e),this.state={value:"",isCustom:!1,customText:""};const{schema:t,id:a,options:s,value:r,required:n,disabled:o,readonly:i,autofocus:c,onChange:l,onBlur:d,onFocus:u,onClick:m,placeholder:p}=e}processValue({type:e,items:t},a){const s=new Set(["number","integer"]);if(""!==a)return"array"===e&&t&&s.has(t.type)?a.map(N.asNumber):"boolean"===e?"true"===a:"number"===e?Object(N.asNumber)(a):a}getValue(e,t){return e.target.value}onChange(e){}render(){const{enumOptions:e,enumDisabled:t}=this.props.options,a=this.props.id,s=this.props.schema;return r.a.createElement("div",{className:"select-widget"},r.a.createElement("input",{id:a,type:"hidden",readOnly:!0,required:this.props.required,noValidate:!0,value:void 0===this.state.value?"":this.state.value}),r.a.createElement("div",{"data-id":a,className:"select-widget-dropdown form-control","data-value":"undefined"==typeof value?"":value},e.map(({value:e,label:t},a)=>{let n;return t.includes(":")&&(n=t?t.split(":")[1]:"",t=t?t.split(":")[0]:""),r.a.createElement("div",{className:this.state.value===e?"option selected":"option","data-value":n||e,key:a,onClick:e=>{const t=e.currentTarget.dataset.value;this.setState({value:t,isCustom:!1}),this.props.onChange(this.processValue(s,t))}},r.a.createElement("div",{className:"option-label"},t),t?r.a.createElement("div",{className:"option-desc"},n):"")}),r.a.createElement("div",{className:this.state.isCustom?"option selected":"option","data-value":this.state.customText,onClick:e=>{const t=this.state.customText;this.setState({isCustom:!0,value:t}),this.props.onChange(this.processValue(s,t))}},"Write your own")),r.a.createElement("textarea",{className:this.state.isCustom?"form-control":"hidden",onChange:e=>{const t=e.target.value;this.setState({customText:t}),this.props.onChange(this.processValue(s,t))}}))}}k.defaultProps={autofocus:!1};var j=k;var L=class extends r.a.Component{constructor(e){super(e),this.state={mediaData:this.props.mediaData},this.onChange=this.onChange.bind(this),this.onBlur=this.onBlur.bind(this),this.onFocus=this.onFocus.bind(this)}componentDidMount(){}componentWillUnmount(){}componentDidUpdate(e,t,a){}onFocus(e){const t=e.split("_")[1];this.setState({activeCorner:t}),this.props.sendActiveCorner(t)}onBlur(e){}getMediaData(e,t,a,s){if(!C()(e))return;const r=encodeURIComponent(e),n=Object.assign({},this.state.mediaData);let o="";switch(t){case"youtube":o="https://www.youtube.com/oembed?url="+r;break;case"vimeo":o="https://vimeo.com/api/oembed.json?url="+r;break;case"soundcloud":o="https://soundcloud.com/oembed?format=json&url="+r;break;default:return!1}fetch(o).then(e=>{if(!e.ok)throw Error(e.statusText);return e.json()}).then(e=>{n[a][s]={html:e.html,width:e.width,height:e.height},this.setState({mediaData:n}),this.props.sendMediaData(n)}).catch(function(e){console.log(e)})}onChange(e){const t=e.formData,a=Object.keys(t),s=Object.assign({},this.props.mediaData);for(let e of a)if(t[e]&&t[e].media)for(let a of t[e].media.keys()){const r=t[e].media[a],n=r.url,o=r.type;s[e]||(s[e]=[]),s[e][a]||(s[e][a]="",this.setState({mediaData:s})),n&&o&&this.getMediaData(n,o,e,a)}Object.assign(this.props.formData,t),this.props.sendFormData(e.formData)}onError(e){}translateSchema(e){this.state.lang;const t=Object.assign({},e),a=Object.keys(e.properties),s=this.props.creator.acf;for(let r of a){let a=e.properties[r];const n=[r,"title"].join("_");a.title=s[n];const o=[r,"desc"].join("_");a.description=s[o];const i=a.properties;if(i){const e=Object.keys(i);for(let t of e){const e=[r,t,"label"].join("_");if(s.hasOwnProperty(e)){const r=s[e];a.properties[t].title=r}const n=[r,t,"desc"].join("_");if(s.hasOwnProperty(n)){const e=s[n];a.properties[t].description=e}if(i[t].hasOwnProperty("enum")){const e=s[[r,t,"options"].join("_")];if(a.properties[t].enum=[],a.properties[t].enumNames=[],e)for(let s of e){const e=s.label+(s.desc?": "+s.desc:"");a.properties[t].enum.push(e),a.properties[t].enumNames.push(e)}}if("array"==i[t].type){const e=i[t].items.properties,n=Object.keys(e);for(let e of n){const n=[r,e,"label"].join("_");if(s.hasOwnProperty(n)){const r=s[n];a.properties[t].items.properties[e].title=r}}}}}t.properties[r]=a}return t}renderForm(){const e={customSelectWidget:j};return r.a.createElement("div",{className:"col-inner"},r.a.createElement("div",{id:"forms",className:"half-max-width"},r.a.createElement(y.a,{schema:this.translateSchema(S),uiSchema:D,widgets:e,formData:this.props.formData,validate:w,liveValidate:!0,onFocus:this.onFocus,onBlur:this.onBlur,onChange:this.onChange,onError:this.onError},r.a.createElement("button",{type:"submit",hidden:!0}),r.a.createElement("button",{type:"button",className:"btn"},"Add content in another language"))))}render(){return r.a.createElement(r.a.Fragment,null,this.renderForm())}},x=a(138);a(129);var O=class extends r.a.Component{constructor(e){super(e),this.state={embedData:{copyright:{},backstory:{},context:{},links:{}}}}componentDidMount(){}componentWillUnmount(){}componentDidUpdate(e,t,a){}renderMedia(){const e=[],t=this.props.cornerSlug,a=(this.props.fieldSlug,Object.assign({},this.state.embedData[t]),Object.assign({},this.props.mediaData));if(this.props.fieldData)return this.props.fieldData.forEach((t,s)=>{let n="";if("image"==t.type)n=!!t.url&&r.a.createElement("img",{src:t.url,alt:""});else if(a&&a[s]){const e=a[s];console.log(e.width,e.height),n=!!e&&r.a.createElement("div",{className:"fc-media",dangerouslySetInnerHTML:{__html:e.html}})}const o=t.credit?r.a.createElement("div",{className:"fc-sub-credit"},t.credit):"",i=r.a.createElement("div",{className:"fc-sub-row",key:s},n,o);e.push(i)}),r.a.createElement("div",{className:"fc-sub-rows"},e)}renderLinks(){const e=[];return this.props.fieldData.forEach((t,a)=>{if(!t.url)return;r.a.createElement("img",{src:t.url,alt:""});const s=r.a.createElement("div",{className:"fc-sub-row",key:a},t.title?r.a.createElement("div",{className:"fc-sub-title"},t.title):"",r.a.createElement("div",{className:"fc-sub-url"},t.url));e.push(s)}),r.a.createElement("div",{className:"fc-sub-rows"},e)}renderEntry(){switch(this.props.fieldSlug){case"media":return this.renderMedia();case"links":return this.renderLinks();default:return this.props.fieldData}}render(){return this.props.cornerSlug,this.props.fieldSlug,r.a.createElement("div",{className:this.props.fieldData?"fc-row":"fc-row fc-empty"},this.props.fieldLabel?r.a.createElement("div",{className:"fc-label"},this.props.fieldLabel):"",this.props.fieldData?r.a.createElement("div",{className:"fc-value"},this.renderEntry()):"")}};var F=class extends r.a.Component{constructor(e){super(e),this.state={},this.imgInputRef=r.a.createRef(),this.corners=["context","links","copyright","backstory"]}componentDidMount(){const e=FourCorners.default.prototype.init()[0],t=this.props.activeCorner;this.FourCorners=e,t&&this.FourCorners.openCorner(t)}componentDidUpdate(e){const t=this.props.activeCorner;t&&this.FourCorners.openCorner(t)}onChangeOpts(e){let t={formData:this.props.formData};t[e.target.id]=e.target.checked,this.setState(t)}onFocus(e){e.target.setSelectionRange(0,e.target.value.length)}onBlur(e){}onError(e){console.log("Error",e)}onScroll(e){}renderPanels(){const e={};Object.entries(this.props.formData).map(t=>this.corners.includes(t[0])?e[t[0]]=t[1]:"");const t=[],a=this.props.creator.acf;return Object.entries(e).forEach((e,s)=>{const n=e[0],o=[n,"title"].join("_"),i=a[o],c=e[1],l=[];Object.entries(c).forEach((e,t)=>{const s=e[0],o=e[1];let i="";if(!["media","links"].includes(s)){const e=[n,s,"label"].join("_");i=a[e]}const c=this.props.mediaData[n];l.push(r.a.createElement(O,{cornerSlug:n,fieldLabel:i,fieldSlug:s,fieldData:o,mediaData:c,key:t}))}),t.push(r.a.createElement("div",{"data-slug":n,className:"fc-panel",key:s},r.a.createElement("div",{className:"fc-panel-title"},i),r.a.createElement("div",{className:"fc-inner"},l)))}),t}render(){return r.a.createElement("div",{className:this.props.imgLoaded?"fc-embed card":"fc-embed"},r.a.createElement("div",{className:this.props.imgLoaded?"fc-photo fc-loaded":"fc-photo"},r.a.createElement("img",{src:this.props.imgSrc,className:"fc-img"})),this.renderPanels())}};let R=SiteSettings.url.theme+"/assets/images/placeholder.svg";var _=class extends r.a.Component{constructor(e){super(e),this.state={imgLoaded:!1,imgFocus:!1,imgSrc:R,includeCss:!1,includeJs:!1,stickyStyle:{}},this.imgInputRef=r.a.createRef(),this.outputRef=r.a.createRef(),this.includeJSRef=r.a.createRef(),this.includeCSSRef=r.a.createRef(),this.stickyRef=r.a.createRef()}componentDidMount(){window.addEventListener("scroll",this.onScroll.bind(this)),window.addEventListener("resize",this.onScroll.bind(this))}componentWillUnmount(){window.removeEventListener("scroll",this.onScroll.bind(this)),window.removeEventListener("resize",this.onScroll.bind(this))}shouldComponentUpdate(e,t){return!0}componentDidUpdate(e){}onDropLoad(e){}onDropError(e){}onChangeDrop(e){let t=e.target.value,a=new Image;a.onload=(e=>{this.setState({imgSrc:t,imgLoaded:!0})}),a.onerror=(e=>{this.setState({imgSrc:R,imgLoaded:!1})}),a.src=t}onDrop(e){let t=URL.createObjectURL(e[0]);this.setState({imgSrc:t,imgLoaded:!0,imgFocus:!1})}onFocusDrop(e){this.setState({imgFocus:!0})}onBlurDrop(e){this.setState({imgFocus:!1})}onChangeOpts(e){let t={formData:this.props.formData};t[e.target.id]=e.target.checked,this.setState(t)}onFocus(e){e.target.setSelectionRange(0,e.target.value.length)}onBlur(e){}onError(e){console.log("Error",e)}onScroll(e){const t=this.stickyRef.current.parentElement.getBoundingClientRect(),a=t.width;window.innerHeight;let s={};t.top<=60&&(s={width:a+"px",height:"100%",position:"fixed",top:0,right:0,paddingTop:"60px"}),this.setState({stickyStyle:s})}embedCode(e){let t={lang:f.language,img:this.state.imgLoaded?this.state.imgSrc:void 0},a=Object.assign(e,t),s="<div class='fc-embed' data-fc='"+JSON.stringify(a).replace(/'/g,"&apos;")+"'></div>";return s+=this.state.includeJs?'<script src=https://cdn.jsdelivr.net/gh/four-corners/four-corners.js/dist/four-corners.min.js type="text/javascript"><\/script>':"",s+=this.state.includeCss?'<link href="https://cdn.jsdelivr.net/gh/four-corners/four-corners.js/dist/four-corners.min.css" rel="stylesheet" type="text/css">':""}render(){const e=this.props.creator.acf,t=this.state.imgLoaded?"has-image":"",a="form-group"+(this.state.imgLoaded?"":" card")+(this.state.imgFocus?" focus":""),s="drop"+(this.state.imgLoaded?" under card":" over");return r.a.createElement("div",{className:"col-inner"},r.a.createElement("div",{className:"sticky",style:this.state.stickyStyle,ref:this.stickyRef},r.a.createElement("div",{className:"half-max-width"},r.a.createElement("legend",null,e.photo_title),r.a.createElement("div",{className:"field-description"},e.photo_desc),r.a.createElement("div",{id:"embedder"},r.a.createElement("div",{id:"embed-input",className:t},r.a.createElement("div",{className:a},r.a.createElement(F,{creator:this.props.creator,imgSrc:this.state.imgSrc,imgLoaded:this.state.imgLoaded,formData:this.props.formData,mediaData:this.props.mediaData,activeCorner:this.props.activeCorner}),r.a.createElement("div",{className:s},r.a.createElement(x.a,{className:"drop-zone",ref:this.imgInputRef,style:{},accept:"image/jpeg, image/png, image/gif",multiple:!1,onDrop:this.onDrop.bind(this),onClick:this.onFocusDrop.bind(this),onMouseEnter:this.onFocusDrop.bind(this),onMouseLeave:this.onBlurDrop.bind(this),onDragEnter:this.onFocusDrop.bind(this),onDragLeave:this.onBlurDrop.bind(this),onFileDialogCancel:this.onBlurDrop.bind(this),onBlur:this.onBlurDrop.bind(this)}),this.state.imgLoaded?r.a.createElement("div",{className:"label-text"},e.drag_drop):""),this.state.imgLoaded?"":r.a.createElement("div",{className:"label-text"},e.drag_drop)),r.a.createElement("div",{className:"form-group image-src"},r.a.createElement("input",{className:"form-control",id:"image-src-url",name:"src",placeholder:e.copy_paste,onChange:this.onChangeDrop.bind(this),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}))),r.a.createElement("div",{id:"embed-output"},r.a.createElement("legend",null,this.props.creator.acf.embed_title),r.a.createElement("p",{className:"field-description"},e.embed_desc),r.a.createElement("textarea",{className:"output form-control",id:"json",readOnly:!0,ref:this.outputRef,rows:5,value:this.embedCode(this.props.formData),onFocus:this.onFocus.bind(this),onBlur:this.onBlur.bind(this)}),r.a.createElement("form",{name:"embed-opts",onChange:this.onChangeOpts.bind(this)},r.a.createElement("label",null,"Embed Options"),r.a.createElement("div",{className:"embed-opts checkboxes"},r.a.createElement("label",{className:"control-label",htmlFor:"includeJs"},r.a.createElement("input",{className:"embed-opt",id:"includeJs",name:"includeJs",type:"checkbox",defaultChecked:this.state.includeJs})," Include JavaScript file"),r.a.createElement("label",{className:"control-label",htmlFor:"includeCss"},r.a.createElement("input",{className:"embed-opt",id:"includeCss",name:"includeCss",type:"checkbox",defaultChecked:this.state.includeCss})," Include CSS file"))))))))}};var M=class extends r.a.Component{constructor(e){super(e),this.state={creator:{},lang:"en",formData:{},mediaData:{context:[],backstory:[]},activeCorner:null},this.onLanguageChanged=this.onLanguageChanged.bind(this),this.outputRef=r.a.createRef()}componentDidMount(){let e=this,t=(window.location.href.split("/"),f.language),a=SiteSettings.url.api+"creators?lang="+t;fetch(a).then(function(e){if(!e.ok)throw Error(e.statusText);return e.json()}).then(function(t){e.setState({creator:t[0]})}),f.on("languageChanged",this.onLanguageChanged)}componentWillUnmount(){f.off("languageChanged",this.onLanguageChanged)}componentDidUpdate(){}onLanguageChanged(e){this.setState({lang:e})}getEmbedId(e,t){e&&isUrl(e)}setFormData(e){this.setState({formData:e})}setMediaData(e){this.setState({mediaData:e})}setActiveCorner(e){this.setState({activeCorner:e})}renderLeft(){return r.a.createElement(L,{lang:this.state.lang,creator:this.state.creator,formData:this.state.formData,sendActiveCorner:this.setActiveCorner.bind(this),sendFormData:this.setFormData.bind(this),sendMediaData:this.setMediaData.bind(this)})}renderRight(){return r.a.createElement(_,{lang:this.state.lang,creator:this.state.creator,formData:this.state.formData,mediaData:this.state.mediaData,activeCorner:this.state.activeCorner})}render(){return this.state.lang,r.a.createElement("div",{id:"creator"},r.a.createElement("div",{className:"row","data-sticky-container":!0},r.a.createElement("div",{className:"col-12 col-sm-6 left"},this.state.creator&&this.state.creator.ID?this.renderLeft():null),r.a.createElement("div",{className:"col-12 col-sm-6 right"},this.state.creator&&this.state.creator.ID?this.renderRight():null)))}};var B=()=>React.createElement("div",null,React.createElement("div",{className:"container"},React.createElement("h1",null,"Not Found")));a(315),a(316);const I=r.a.createElement(o.a,null,e=>r.a.createElement(i.a,null,r.a.createElement(r.a.Fragment,null,r.a.createElement(b,null),r.a.createElement(c.a,null,r.a.createElement(l.a,{exact:!0,path:SiteSettings.path,component:M}),r.a.createElement(l.a,{exact:!0,path:SiteSettings.path+"creator",component:M}),r.a.createElement(l.a,{path:"*",component:B})))));Object(n.render)(I,document.getElementById("page"))}});